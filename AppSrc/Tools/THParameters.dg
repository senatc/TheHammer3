Use Windows.pkg
Use cImageList32.pkg
Use dfSpnFrm.pkg
Use Tools\Language.sl
Use Tools\Compilers.sl
Use Tools\TH3NewColorSchema.dg
Use Tools\TH3NewLanguage.dg
Use dfLine.pkg
Use dfTreeVw.pkg
Use Colr_Dlg.pkg
Use cRichEdit.pkg
Use THColorer.pkg
Use Font_dlg.pkg
Use THDialog.pkg

Object oTHParameters is a ModalPanel
    Set Size to 275 445
    Set Label to "The Hammer Options"
    Set piMinSize to 275 445
    Set Location to 2 2
    Set peAnchors to anAll
    Set Locate_Mode to CENTER_ON_SCREEN
    Set Icon to "Configure16.ico"
    Set piMaxSize to 275 445
    Set Border_Style to Border_WindowEdge

    Object oParameters is a TabDialog
        Set Size to 248 437
        Set Location to 5 5

        Object oParaImageList is a cImageList32
            Set piMaxImages to 10
            Procedure OnCreate // add the images
                Integer iImage
                Get AddBitmap 'THParameters16.bmp' clFuchsia to iImage
            End_Procedure
        End_Object
        Set phoImageList to (oParaImageList(Self))

        Object oEditorPage is a TabPage
            Set Label to "&1. Editor"
            Set piImageIndex to 0

            Object oEditorTabDialog is a TabDialog
                Set Size to 229 429
                Set Location to 3 2
                Set peTabStyle to tsFlatButtons

                Object oFilesPage is a TabPage
                    Set Label to "Files"

                    Object oFilesGrp is a Group
                        Set Size to 210 420
                        Set Location to 0 3
                        Set peAnchors to anAll

                        Object oRecentFiles is a cNotifierSpinForm
                            Set Size to 13 40
                            Set Location to 10 71
                            Set Label to "Recent opened files"
                            Set Status_Help to "Number of recently opened files in File menu."
                        End_Object

                        Object oRecentWorkspaces is a cNotifierSpinForm
                            Set Size to 13 40
                            Set Location to 10 159
                            Set Label to "workspaces"
                            Set Status_Help to "Number of recently opened workspaces in File menu."
                        End_Object

                        Object oOpenFiles is a cTHWSGrid
                            Property String  psSepCharacter  Public "|"
                            Set Size to 161 193
                            Set Location to 26 7
                            Set Line_Width      to 2 0
                            Set Form_Width      0 to 130
                            Set Header_Label    0 to "Open Dialog Description"
                            Set Form_Width      1 to 60
                            Set Header_Label    1 to "Extension"
                            Set Status_Help item 0 to "Descriptions to be shown in The Hammer Open File Dialog"
                            Set Status_Help item 1 to "Extensions to be shown in The Hammer Open File Dialog"
                            On_Key key_F2 Send Request_SaveAllEntries
                            On_Key kCancel Send Close_Panel
                            Procedure OnChange Integer iItem
                                Delegate Send NotifyChange
                            End_Procedure
                            Procedure Add_New_Line String sName String sDesc Integer iColor
                                Send Add_Item Msg_None sName
                                If (iColor) Set ItemTextColor (Item_Count(Self)-1) to iColor
                                Send Add_Item Msg_None sDesc
                                If (iColor) Set ItemTextColor (Item_Count(Self)-1) to iColor
                            End_Procedure
                            Procedure mInsertLine
                                Send Add_New_Line "" "" clRed
                                Send onChange 0
                                Send End_of_Data
                            End_Procedure
                            Procedure mRemoveLine
                                Integer iRowBase
                                If (Item_Count(Self)=0) Procedure_Return
                                Get Base_Row_Item (Current_Item(Self)) to iRowBase
                                Send Delete_Item (iRowBase+1)
                                Send Delete_Item iRowBase
                                Send onChange 0
                            End_Procedure
                            Procedure SetValue String sVal
                                Integer hoID iC
                                String sSep
                                Send Delete_Data
                                Get psSepCharacter  to sSep
                                Object oParser is a cLineParser
                                    Set psSepCharacter  to sSep
                                    Move Self   to hoID
                                End_Object
                                Send ParseLine to hoID sVal
                                For iC from 0 to (Item_Count(hoID)-1)
                                    Send Add_Item Msg_None (Value(hoID,iC))
                                End
                                Send Destroy_Object to hoID
                            End_Procedure
                            Function GetValue Returns String
                                Integer iItem iItems
                                String sSep sRetVal sVal
                                Get Item_Count to iItems
                                If (iItems=0) Function_Return ""
                                Get psSepCharacter  to sSep
                                For iItem from 0 to (iItems-1)
                                    Get Value item iItem to sVal
                                    If (sRetVal="") Move sVal to sRetVal
                                    Else Move (sRetVal+sSep+sVal) to sRetVal
                                Loop
                                Function_Return sRetVal
                            End_Function
                        End_Object
                        Object oAdd is a Button
                            Set Location to 190 6
                            Set Label to "Add (Ins)"
                            Procedure OnClick
                                Send mInsertLine to oOpenFiles
                            End_Procedure
                        End_Object
                        Object oRemove is a Button
                            Set Location to 190 61
                            Set Label to "Remove (Del)"
                            Procedure OnClick
                                Send mRemoveLine to oOpenFiles
                            End_Procedure
                        End_Object

                        Object oAssociate is a Button
                            Set Size to 14 84
                            Set Location to 190 116
                            Set Label to "Associate File Types"
                            Procedure OnClick
                                Integer iRet
                                String sStr
                                Append sStr "All listed filetypes will be assiciated to The Hammer!\n"
                                Append sStr "You need administrator rights to do this.\n\n"
                                Append sStr "Proceed?"
                                Get YesNo_Box sStr  to iRet
                                If iRet Ne MBR_Yes Procedure_Return
                                Send SaveEntries
                                Send AsociateAllFileTypes
                            End_Procedure
                        End_Object

                        Object oLanguage is a cNotifierForm
                            Set Size to 13 135
                            Set Location to 10 278
                            Set Prompt_Button_Mode to PB_PromptOn
                            Set Label to "Default Language"
                            Set Status_Help to "Default language to be used on TheHammer startup"
                            Set Prompt_Object item 0 to (oLanguage_SL(Self))
                            Procedure Key Integer iKey Returns Integer
                                Integer iRetVal
                                // Left, Right, Shft+Left, Shift+Right, Home, End, Shft+Home, Shft+End
                                If ((iKey=260)or(iKey=261)or(iKey=5127)or(iKey=5128)or ;
                                    (iKey=294)or(iKey=295)or(iKey=5129)or(iKey=5130) ) ;
                                Forward Get Msg_Key iKey to iRetVal
                                Procedure_Return iRetVal
                            End_Procedure
                            Function CanPaste Returns Boolean
                                Function_Return False
                            End_Function
                            Function CanCut Returns Boolean
                                Function_Return False
                            End_Function
                            Function CanDelete Returns Boolean
                                Function_Return False
                            End_Function
                            Function CanUndo Returns Boolean
                                Function_Return False
                            End_Function
                            Procedure Paste Integer Arg1 Integer Arg2 Integer Arg3
                            End_Procedure
                            Procedure Cut Integer Arg1 Integer Arg2 Integer Arg3
                            End_Procedure
                            Procedure Delete
                            End_Procedure
                            Procedure Undo
                            End_Procedure
                        End_Object

                        Object oAssignFiles is a cTHWSGrid
                            Set Size to 161 193
                            Set Location to 26 221
                            Set Line_Width      to 2 0
                            Set Form_Width      0 to 130
                            Set Header_Label    0 to "Assign Language [F4]"
                            Set Form_Width      1 to 60
                            Set Header_Label    1 to "to Extension"
                            Set Status_Help item 0 to "Use specific language to open this file"
                            Set Status_Help item 1 to "Specify file extension to allocate specific language"
                            On_Key key_F2   Send Request_SaveAllEntries
                            On_Key kCancel  Send Close_Panel
                            On_Key Key_F4   Send Prompt
                            Procedure Key Integer iKey Returns Integer
                                Integer iRetVal iRowBase
                                Get Base_Row_Item (Current_Item(Self)) to iRowBase
                                If (Current_Item(Self)=iRowBase) Begin
                                    // Left, Right, Shft+Left, Shift+Right, Home, End, Shft+Home, Shft+End
                                    If ((iKey=260)or(iKey=261)or(iKey=5127)or(iKey=5128)or ;
                                        (iKey=294)or(iKey=295)or(iKey=5129)or(iKey=5130) ) ;
                                    Forward Get Msg_Key iKey to iRetVal
                                End
                                Else Forward Get Msg_Key iKey to iRetVal
                                Procedure_Return iRetVal
                            End_Procedure
                            Procedure Paste
                                Integer iRowBase
                                Get Base_Row_Item (Current_Item(Self)) to iRowBase
                                If (Current_Item(Self)<>iRowBase) ;
                                    Forward Send Paste
                            End_Procedure
                            Procedure Cut Integer Arg1 Integer Arg2 Integer Arg3
                            End_Procedure
                            Procedure Delete
                            End_Procedure
                            Function CanPaste Returns Boolean
                                Integer iRowBase
                                Get Base_Row_Item (Current_Item(Self)) to iRowBase
                                If (Current_Item(Self)<>iRowBase) ;
                                    Function_Return True
                                Function_Return False
                            End_Function
                            Function CanCut Returns Boolean
                                Integer iRowBase
                                Get Base_Row_Item (Current_Item(Self)) to iRowBase
                                If (Current_Item(Self)<>iRowBase) ;
                                    Function_Return True
                                Function_Return False
                            End_Function
                            Function CanDelete Returns Boolean
                                Function_Return False
                            End_Function
                            Procedure Header_Mouse_Click Integer Item#
                                Forward Send Header_Mouse_Click Item#
                                If (Item#=0) Send Prompt
                            End_Procedure
                            Procedure OnChange Integer iItem
                                Delegate Send NotifyChange
                            End_Procedure
                            Procedure Add_New_Line String sName String sDesc Integer iColor
                                Send Add_Item Msg_None sName
                                If (iColor) Set ItemTextColor (Item_Count(Self)-1) to iColor
                                Send Add_Item Msg_None sDesc
                                If (iColor) Set ItemTextColor (Item_Count(Self)-1) to iColor
                            End_Procedure
                            Procedure mInsertLine
                                Send Add_New_Line "" "" clRed
                                Send onChange 0
                                Send End_of_Data
                            End_Procedure
                            Procedure mRemoveLine
                                Integer iRowBase
                                If (Item_Count(Self)=0) Procedure_Return
                                Get Base_Row_Item (Current_Item(Self)) to iRowBase
                                Send Delete_Item (iRowBase+1)
                                Send Delete_Item iRowBase
                                Send onChange 0
                            End_Procedure
                            Procedure Prompt
                                Integer iRowBase
                                If (Item_Count(Self)=0) Procedure_Return
                                Get Base_Row_Item (Current_Item(Self)) to iRowBase
                                If (iRowBase=Current_Item(Self)) ;
                                  Send Popup to (oLanguage_SL(Self))
                            End_Procedure
                        End_Object

                        Object oAdd is a Button
                            Set Location to 190 220
                            Set Label to "Add (Ins)"
                            Procedure OnClick
                                Send mInsertLine to oAssignFiles
                            End_Procedure
                        End_Object
                        Object oRemove is a Button
                            Set Location to 190 275
                            Set Label to "Remove (Del)"
                            Procedure OnClick
                                Send mRemoveLine to oAssignFiles
                            End_Procedure
                        End_Object
                    End_Object // oFilesGrp
                End_Object // oFilesPage

                Object oCodeListPage is a TabPage
                    Set Label to "Code Lists"

                    Object oCodeListGrp is a Group
                        Set Size to 210 205
                        Set Location to 0 3
                        Set peAnchors to anAll
                        Set Label to "Show Code List for"

                        Object oClasses is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 20 55
                            Set Label to "Class Names"
                            Set Status_Help to "Show Codelist if Class Name reason"
                        End_Object

                        Object oObjects is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 36 55
                            Set Label to "Object Names"
                            Set Status_Help to "Show Codelist if Object Name reason"
                        End_Object

                        Object oMethods is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 52 55
                            Set Label to "Procedures and Functions"
                            Set Status_Help to "Show Codelist if Procedure/Function Name reason"
                        End_Object

                        Object oKeys is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 68 55
                            Set Label to "Key Symbolic Names"
                            Set Status_Help to "Show Codelist if Key Symbolic Name reason"
                        End_Object

                        Object oFields is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 84 55
                            Set Label to "Data File Fields"
                            Set Status_Help to "Show Codelist if Database Field (Column) Name reason"
                        End_Object

                        Object oIndexes is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 100 55
                            Set Label to "Data File Indexes"
                            Set Status_Help to "Show Codelist if Database File Index reason"
                        End_Object

                        Object oVariables is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 116 55
                            Set Label to "Local Variables"
                            Set Status_Help to "Show Codelist if Local Variable Name reason"
                        End_Object

                        Object oStructures is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 132 55
                            Set Label to "Structures"
                            Set Enabled_State to False
                            Set Status_Help to "Show Codelist if Structure Name reason (Under Review)"
                        End_Object

                        Object oTags is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 148 55
                            Set Label to "Studio/IDE Tags"
                            Set Status_Help to "Show Codelist if Studio/IDE Tag Name reason"
                        End_Object

                        Object oCommands is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 164 55
                            Set Label to "Commands"
                            Set Status_Help to "Show Codelist if Language Command Name reason"
                        End_Object

                        Object oTypes is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 180 55
                            Set Label to "Types"
                            Set Status_Help to "Show Codelist if Variable Type expected"
                        End_Object

                        Object oAttributes is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 196 55
                            Set Label to "Attributes"
                            Set Status_Help to "Show Codelist if Get_/Set_Attribute command used"
                        End_Object
                        
                    End_Object // oCodeListGrp

                    Object oOptionsGrp is a Group
                        Set Size to 210 210
                        Set Location to 0 213
                        Set peAnchors to anAll
                        Set Label to "Code Lists and Code Tips"

                        Object oBitmaps is a cNotifierCheckBox
                            Set Location to 20 75
                            Set Size to 10 50
                            Set Label to "Use Bitmaps (Works slower)"
                            Set Status_Help to "Show Bitmaps within Codelists (may work slower)"
                        End_Object

                        Object oCodeTips is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 36 75
                            Set Label to "Enable Code Tips"
                            Set Status_Help to "Enables or disables CodeTip popup"
                        End_Object

                        Object oCodeTipPopup is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 52 75
                            Set Label to "Code Tip Auto-Popup"
                            Set Status_Help to "Show Codetip automatically on function call"
                        End_Object

                        Object oFunctionsINI is a cNotifierForm
                            Set Size to 13 100
                            Set Location to 68 75
                            Set Prompt_Button_Mode to PB_PromptOn
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to JMode_Right
                            Set Label to "Functions INI File"
                            Set Status_Help to "The Hammer INI file with functions defined for CodeTips"
                            Procedure Prompt
                                Integer hoID bRet hoWorkspace
                                String  sFileName sIniDir
                                Object oOpenDialog is a OpenDialog
                                    Set Location to 5 471
                                    Set Dialog_Caption to "Please Select INI file"
                                    Set Filter_String to "INI Files|*.INI|All Files|*.*"
                                    Set NoChangeDir_State   to True
                                    Move Self to hoID
                                End_Object    // oOpenDialog
                                If (hoID <> 0) Begin
                                    // By SVN on 08/04/2017 -- Although it opens INI from TH workspace,
                                    // File Selector is based on the Project workspace (changed to TH)
                                    //Get CurrentProgramPath of ghoWorkSpaceHandlerEx to sIniDir
                                    Get phoWorkspace of ghoApplication to hoWorkspace
                                    Get psProgramPath of hoWorkspace to sIniDir
                                    Set Initial_Folder of hoID to sIniDir
                                    Get Show_Dialog of hoID to bRet
                                    If bRet Begin
                                        Get File_Title of hoID to sFileName
                                        Set Value item 0 to sFileName
                                    End
                                End
                                Send Request_Destroy_Object to hoID
                            End_Procedure
                        End_Object

                        Object oTokensINI is a cNotifierForm
                            Set Size to 13 100
                            Set Location to 84 75
                            Set Prompt_Button_Mode to PB_PromptOn
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to JMode_Right
                            Set Label to "Tokens INI File"
                            Set Status_Help to "The Hammer INI file with tokens defined for CodeLists"
                            Procedure Prompt
                                Integer hoID bRet hoWorkspace
                                String  sFileName sIniDir
                                Object oOpenDialog is a OpenDialog
                                    Set Location to 5 471
                                    Set Dialog_Caption to "Please Select INI file"
                                    Set Filter_String to "INI Files|*.INI|All Files|*.*"
                                    Set NoChangeDir_State   to True
                                    Move Self to hoID
                                End_Object    // oOpenDialog
                                If (hoID <> 0) Begin
                                    // By SVN on 08/04/2017 -- Although it opens INI from TH workspace,
                                    // File Selector is based on the Project workspace (changed to TH)
                                    //Get CurrentProgramPath of ghoWorkSpaceHandlerEx to sIniDir
                                    Get phoWorkspace of ghoApplication to hoWorkspace
                                    Get psProgramPath of hoWorkspace to sIniDir
                                    Set Initial_Folder of hoID to sIniDir
                                    Get Show_Dialog of hoID to bRet
                                    If bRet Begin
                                        Get File_Title of hoID to sFileName
                                        Set Value item 0 to sFileName
                                    End
                                End
                                Send Request_Destroy_Object to hoID
                            End_Procedure
                        End_Object
                        
                    End_Object // oOptionsGrp

                End_Object // oCodeListPage

                Object oColorerPage is a TabPage
                    Set Label to "Colorer"

                    Object oSchemaGroup is a Group
                        Set Size to 30 423
                        Set Location to -2 1
                        Set Label to "Color Schema"
        
                        Object oSchemaSelect is a ComboForm
                            Set Size to 13 100
                            Set Location to 10 75
                            Set Label to "Name"
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to JMode_Right
        
                            On_Key key_F2 Send SaveEntries
                            On_Key kCancel Send Close_Panel
                            Procedure Combo_Fill_List
                                Integer iCount iC
                                String  sStr sCur
                                // Defauls Schemas
                                Send Combo_Add_Item TH_DEFSCHEMA_WHITE_STR
                                Send Combo_Add_Item TH_DEFSCHEMA_BLACK_STR
                                Send Combo_Add_Item TH_DEFSCHEMA_BLUE_STR
                                // Custom Schemas
                                Get psColorSchemas.Count of ghoEditorProperties to iCount
                                For iC from 0 to (iCount-1)
                                    Get psColorSchemas of ghoEditorProperties item iC  to sStr
                                    Send Combo_Add_Item sStr
                                End
                                Get psColorSchema of ghoEditorProperties to sCur
                                If (sCur="") Begin
                                    Move TH_DEFSCHEMA_WHITE_STR to sCur
                                    Set psColorSchema of ghoEditorProperties to sCur
                                End
                                //
                                Set Value item 0    to sCur
                                Set Entry_State     to False
                            End_Procedure  // Combo_fill_list
                            
                            Procedure OnChange
                                String sName sSchema sFontStyles
                                Integer iC
                                Integer iDisableManageButtons
                                Get Value item 0 to sName
                                Move TH_COLORSCHEMA_WHITE to sSchema
                                Get psFontStyles of ghoEditorProperties to sFontStyles
                                If (sName=TH_DEFSCHEMA_BLACK_STR) Move TH_COLORSCHEMA_BLACK to sSchema
                                Else If (sName=TH_DEFSCHEMA_BLUE_STR) Move TH_COLORSCHEMA_BLUE to sSchema
                                Else If (sName<>TH_DEFSCHEMA_WHITE_STR) Begin
                                    Get FindColorSchema of ghoEditorProperties sName to iC
                                    If (iC>=0) Begin
                                        Get psColorSchemas.psSchemaColors       of ghoEditorProperties item iC to sSchema
                                        Get psColorSchemas.psSchemaFontStyles   of ghoEditorProperties item iC to sFontStyles
                                    End
                                End
                                //
                                Send SetColorerCurrentStyles sSchema sFontStyles
                                //
                                Send mGeneratePreview to oColorsGroup
                                //
                                Move (not((sName=TH_DEFSCHEMA_BLACK_STR)or(sName=TH_DEFSCHEMA_WHITE_STR)or(sName=TH_DEFSCHEMA_BLUE_STR))) to iDisableManageButtons
                                Set Enabled_State of oSchemaDelete to iDisableManageButtons
                                Set Enabled_State of oSchemaSave   to iDisableManageButtons
                                Delegate Send NotifyChange
                            End_Procedure
            
                        End_Object
        
                        Object oSchemaNew is a Button
                            Set Size to 13 50
                            Set Location to 10 181
                            Set Label to "New"
                        
                            // fires when the button is clicked
                            Procedure OnClick
                                Send Activate to (oSchemaSelect(Self))
                                Send Popup    to (oNewColorSchema(Self))
                            End_Procedure
                        
                        End_Object

                        Object oSchemaSave is a Button
                            Set Size to 13 50
                            Set Location to 10 235
                            Set Label to "Save"
                        
                            // fires when the button is clicked
                            Procedure OnClick
                                String sColors
                                String sName
                                Integer iC
                                Get CurrentColors of oColorsGroup to sColors
                                //
                                Get Value of oSchemaSelect item 0                   to sName
                                Get FindColorSchema of ghoEditorProperties             sName to iC
                                If (iC<0) Get psColorSchemas.Count of ghoEditorProperties    to iC
                                Set psColorSchemas of ghoEditorProperties item iC   to sName
                                Set psColorSchemas.psSchemaColors of ghoEditorProperties item iC   to sColors
                            End_Procedure
                        
                        End_Object

                        Object oSchemaDelete is a Button
                            Set Size to 13 50
                            Set Location to 10 289
                            Set Label to "Delete"
                        
                            // fires when the button is clicked
                            Procedure OnClick
                                String sName
                                Integer iOK
                                Get Value of oSchemaSelect item 0 to sName
                                If ((sName=TH_DEFSCHEMA_BLACK_STR)or(sName=TH_DEFSCHEMA_WHITE_STR)) Begin
                                    Send Stop_Box "Default Schema can not be deleted" "Warning"
                                    Procedure_Return
                                End
                                Get YesNo_Box ('Confirm You wish delete "' + sName + '" color schema?') "Confirmation" MBR_No to iOK
                                If (iOK=MBR_Yes) Begin
                                    Send DeleteColorSchema to ghoEditorProperties sName
                                    Send Combo_Delete_Data to oSchemaSelect
                                    Send Combo_Fill_List   to oSchemaSelect
                                End
                            End_Procedure
                        
                        End_Object

                        Object oSchemaDefault is a Button
                            Set Size to 13 50
                            Set Location to 10 343
                            Set Label to "Default"
                        
                            // fires when the button is clicked
                            Procedure OnClick
                                String sName sColors sFontStyles
                                Integer iOK
                                Get Value of oSchemaSelect item 0 to sName
                                Get YesNo_Box ('Confirm You wish apply default colors to the "' + sName + '" schema?') "Confirmation" MBR_No to iOK
                                If (iOK=MBR_Yes) Begin
                                    Move TH_COLORSCHEMA_WHITE to sColors
                                    If (sName=TH_DEFSCHEMA_BLACK_STR) Move TH_COLORSCHEMA_BLACK to sColors
                                    Else If (sName=TH_DEFSCHEMA_BLUE_STR) Move TH_COLORSCHEMA_BLUE to sColors
                                    Move (Repeat('0', 3*16)+"000") to sFontStyles
                                    Send SetColorerCurrentStyles sColors sFontStyles
                                    Send mGeneratePreview     to oColorsGroup
                                End
                            End_Procedure
                        
                        End_Object
                    End_Object

                    Object oColorsGroup is a Group
                        Set Size to 183 423
                        Set Location to 29 1
                        Set peAnchors to anAll

                        Object oCategory is a TreeView
                            Set Size to 136 100
                            Set Location to 10 7
                            
                            // Initializes colorer and populates the Tree
                            Procedure OnCreateTree
                                Handle  hItem
                                Integer iItem iItems 
                                Move (SizeOfArray(gtColorer)) to iItems
                                For iItem from 0 to (iItems-1)
                                    Get AddTreeItem gtColorer[iItem].sName 0 iItem 0 0 to hItem    
                                Loop
                                Set Visible_State of oColor         to False
                                Set Visible_State of oBackground    to False
                            End_Procedure
                            
                            Procedure OnItemChanged Handle hItem Handle hItemOld
                                Integer iIndex iColor
                                String  sLabel
                                // Collect Item Data of the selected Colorer Item
                                Get ItemData  hItem to iIndex
                                Get ItemLabel hItem to sLabel
                                // Manage color pickers
                                Set Visible_State of oColor         to gtColorer[iIndex].iForeOff 
                                Set Visible_State of oBackground    to gtColorer[iIndex].iBackOff
                                Set Visible_State of oFontBold      to gtColorer[iIndex].iBackOff
                                Set Visible_State of oFontItalics   to gtColorer[iIndex].iBackOff
                                Set Visible_State of oFontUnderline to gtColorer[iIndex].iBackOff
                                // Show the current color if applicable
                                Set piColorerIndex of oColor        to iIndex
                                Set piColorerIndex of oBackground   to iIndex
                                If (gtColorer[iIndex].iForeOff) ;
                                    Set SlectedColor of oColor      to gtColorer[iIndex].iForeC
                                If (gtColorer[iIndex].iBackOff) ;
                                    Set SlectedColor of oBackground to gtColorer[iIndex].iBackC
                                // Font flags
                                Set piColorerIndex of oFontBold     to iIndex
                                Set piColorerIndex of oFontItalics  to iIndex
                                Set piColorerIndex of oFontUnderline to iIndex
                                Set Checked_State of oFontBold      to gtColorer[iIndex].iBold
                                Set Checked_State of oFontItalics   to gtColorer[iIndex].iItalics
                                Set Checked_State of oFontUnderline to gtColorer[iIndex].iUnderline
                                // Notify color picker about current colorer element
                                Send mGeneratePreview
                            End_Procedure
                        
                        End_Object

                        Object oColor is a cColorBox
                            Set Location to 11 114
                            Set Label to "Color"
                            Procedure OnColorChange
                                Integer iColor
                                Get SelectedColor to iColor
                                Move iColor to gtColorer[piColorerIndex(Self)].iForeC
                                Send mGeneratePreview
                                Delegate Send NotifyChange
                            End_Procedure
                        End_Object

                        Object oBackground is a cColorBox
                            Set Location to 36 114
                            Set Label to "Background"
                            Procedure OnColorChange
                                Integer iColor
                                Get SelectedColor to iColor
                                Move iColor to gtColorer[piColorerIndex(Self)].iBackC
                                Send mGeneratePreview
                                Delegate Send NotifyChange
                            End_Procedure
                        End_Object

                        Object oFontBold is a CheckBox
                            Property Integer piColorerIndex
                            Set Size to 10 50
                            Set Location to 64 126
                            Set Label to "Bold"
                            Set FontWeight to fw_Bold
                            Set Visible_State to False
                            Procedure OnChange
                                Get Checked_State to gtColorer[piColorerIndex(Self)].iBold
                                Send mGeneratePreview
                                Delegate Send NotifyChange
                            End_Procedure
                        End_Object

                        Object oFontItalics is a CheckBox
                            Property Integer piColorerIndex
                            Set Size to 10 50
                            Set Location to 78 126
                            Set Label to "Italics"
                            Set FontItalics to True
                            Set Visible_State to False
                            Procedure OnChange
                                Get Checked_State to gtColorer[piColorerIndex(Self)].iItalics
                                Send mGeneratePreview
                                Delegate Send NotifyChange
                            End_Procedure
                        End_Object

                        Object oFontUnderline is a CheckBox
                            Property Integer piColorerIndex
                            Set Size to 10 50
                            Set Location to 92 126
                            Set Label to "Underline"
                            Set FontUnderline to True
                            Set Visible_State to False
                            Procedure OnChange
                                Get Checked_State to gtColorer[piColorerIndex(Self)].iUnderline
                                Send mGeneratePreview
                                Delegate Send NotifyChange
                            End_Procedure
                        End_Object

                        Object oFontGroup is a Group
                            Set Size to 28 211
                            Set Location to 147 7
                            Set Label to "Font"

                            Object oFontFace is a Form
                                Set Size to 13 105
                                Set Location to 10 100
                                Set Label_Col_Offset to 2
                                Set Label_Justification_Mode to JMode_Right
                                Set Label to "Face"
                                Set Prompt_Button_Mode to PB_PromptOn
                                Procedure Key Integer iKey Returns Integer
                                    Integer iRetVal
                                    // Left, Right, Shft+Left, Shift+Right, Home, End, Shft+Home, Shft+End
                                    If ((iKey=260)or(iKey=261)or(iKey=5127)or(iKey=5128)or ;
                                        (iKey=294)or(iKey=295)or(iKey=5129)or(iKey=5130) ) ;
                                    Forward Get Msg_Key iKey to iRetVal
                                    Procedure_Return iRetVal
                                End_Procedure
                                Function CanPaste Returns Boolean
                                    Function_Return False
                                End_Function
                                Function CanCut Returns Boolean
                                    Function_Return False
                                End_Function
                                Function CanDelete Returns Boolean
                                    Function_Return False
                                End_Function
                                Function CanUndo Returns Boolean
                                    Function_Return False
                                End_Function
                                Procedure Paste Integer Arg1 Integer Arg2 Integer Arg3
                                End_Procedure
                                Procedure Cut Integer Arg1 Integer Arg2 Integer Arg3
                                End_Procedure
                                Procedure Delete
                                End_Procedure
                                Procedure Undo
                                End_Procedure
                                Procedure Prompt
                                    Handle hoFontDlg
                                    Integer iOK
                                    String sFace sFontSz sCharSet
                                    Integer iSize iCharset
                                    //
                                    Get Value to sFace
                                    Move (Left(sFace, Pos(';', sFace))) to sFontSz
                                    Move (Trim(Replace(sFontSz, sFace, ""))) to sFace
                                    Move (Replaces(' ', sFontSz, "")) to sFontSz
                                    Move (Left(sFontSz, Length(sFontSz)-3)) to iSize
                                    Move (Left(sFace, Pos(';', sFace))) to sCharSet
                                    Move (Trim(Replace(sCharSet, sFace, ""))) to sFace
                                    Move (Left(sCharSet, Length(sCharSet)-1)) to iCharSet
                                    //
                                    Get Create U_FontDialog     to hoFontDlg
                                    Set Effects_State           of hoFontDlg to False
                                    Set FixedPitchOnly_State    of hoFontDlg to True
                                    Set NoScriptSel_State       of hoFontDlg to False
                                    Set NoStyleSel_State        of hoFontDlg to True
                                    Set ShowHelp_State          of hoFontDlg to False
                                    Set FaceName                of hoFontDlg to sFace
                                    Set FontPointSize           of hoFontDlg to (iSize*10)
                                    Set FontCharSet             of hoFontDlg to iCharSet
                                    Set FontType                of hoFontDlg to REGULAR_FONTTYPE
                                    Get FontDialog              of hoFontDlg to iOK
                                    If (iOk) Begin
                                        Get FaceName            of hoFontDlg to sFace
                                        Get FontPointSize       of hoFontDlg to iSize
                                        Get FontCharSet         of hoFontDlg to iCharset
                                        Set Value               to (String(iSize/10)+"pt;" * String(iCharset)+';' * sFace)
                                        Send mGeneratePreview
                                        Delegate Send NotifyChange
                                    End
                                    Send Destroy                to hoFontDlg
                                End_Procedure
                            End_Object

                        End_Object

                        Object oPreview is a Container3d
                            Set Size to 165 192
                            Set Location to 10 225
                            Set Border_Style to Border_ClientEdge
                            Set Color to clWhite

                            Object oLeftMarginPreview is a Container3d
                                Set Size to 163 14
                                Set Location to 0 0
                                Set Border_Style to Border_None
                            End_Object

                            Object oNumbersPreview is a TextBox
                                Set Auto_Size_State to False
                                Set Size to 163 12
                                Set Location to 0 14
                                Set Label to ("01"+Character(10)+"02"+Character(10)+"03"+Character(10)+"04"+Character(10)+"05"+ ;
                                                   Character(10)+"06"+Character(10)+"07"+Character(10)+"08"+Character(10)+"09"+ ;
                                                   Character(10)+"10"+Character(10)+"11"+Character(10)+"12"+Character(10)+"13"+ ;
                                                   Character(10)+"14"+Character(10)+"15"+Character(10)+"16"+Character(10)+"17"+ ;
                                                   Character(10)+"18"+Character(10)+"19")
                                Set FontWeight to fw_Bold
                                Set Color to clDkGray
                                Set TextColor to clWhite
                                Set Justification_Mode to JMode_Center
                                Set Typeface to "Courier New"
                            End_Object

                            Object oEditorPreview is a cEditorPreview
                                Set Size to 163 162
                                Set Location to 0 29
                            End_Object
                        End_Object
                        
                        Procedure mGeneratePreview
                            Integer iForeColor iBackColor iOriFore iOriBack iForeText iBackText iSize
                            String sFont sFontSize
                            Set Dynamic_Update_State of oEditorPreview to False
                            Send Delete_Data to oEditorPreview
                            // General Appearance
                            // Windows
                            Move gtColorer[EC_WINDOW].iForeC  to iForeColor
                            If (iForeColor<0) Move clWhite to iForeColor
                            Set Color of oEditorPreview to iForeColor
                            Set Color of oPreview to iForeColor
                            // Left Marging
                            Set Color               of oLeftMarginPreview   to gtColorer[EC_LEFTMARGIN].iForeC
                            // Line Numbers
                            Set TextColor           of oNumbersPreview      to gtColorer[EC_LINENUMBERS].iForeC //iForeColor
                            Set Color               of oNumbersPreview      to gtColorer[EC_LINENUMBERS].iBackC //iBackColor
                            Set FontWeight          of oNumbersPreview      to (gtColorer[EC_LINENUMBERS].iBold * 800)
                            Set FontItalics         of oNumbersPreview      to gtColorer[EC_LINENUMBERS].iItalics
                            Set FontUnderline       of oNumbersPreview      to gtColorer[EC_LINENUMBERS].iUnderline
                            // Font
                            Get Value of oFontFace to sFont
                            Move (Left(sFont, Pos(';', sFont))) to sFontSize
                            Move (Trim(Replace(sFontSize, sFont, ""))) to sFont
                            Move (Replace("PT;", Uppercase(sFontSize), "")) to sFontSize
                            Move (Trim(Right(sFont, Length(sFont)-Pos(';', sFont)))) to sFont
                            Move sFontSize to iSize
                            If (iSize=0) Move 12 to iSize
                            If (sFont="") Move "Courier New" to sFont
                            Set psTypeFace          of oEditorPreview to sFont
                            Set piFontSize          of oEditorPreview to ((iSize-2)*20)
                            // Elements
                            Get TextColor           of oEditorPreview to iOriFore
                            Send AddComment         to oEditorPreview "// This is a comment"
                            Send AppendTextLn       to oEditorPreview "" 
                            Send AddMetaTag         to oEditorPreview '{Description="Meta tag"}'
                            Send AppendTextLn       to oEditorPreview "" 
                            Send AddScopeKeyword    to oEditorPreview "Function"
                            Send AddSpacing         to oEditorPreview " " 
                            Send AddText            to oEditorPreview "mFoo" 
                            Send AddText            to oEditorPreview " " 
                            Send AddKeyword         to oEditorPreview "Returns String"
                            Send AppendTextLn       to oEditorPreview "" 
                            Send AddSpacing         to oEditorPreview "    "
                            Send AddKeyword         to oEditorPreview "String"
                            Send AddSpacing         to oEditorPreview " " 
                            Send AddText            to oEditorPreview "sRetVal" 
                            Send AppendTextLn       to oEditorPreview "" 
                            Send AddSpacing         to oEditorPreview "    "
                            Send AddKeyword         to oEditorPreview "Move"
                            Send AddSpacing         to oEditorPreview " "
                            Send AddText            to oEditorPreview "(" 
                            Send AddString          to oEditorPreview '"Hello"' 
                            Send AddSpacing         to oEditorPreview " "
                            Send AddOperator        to oEditorPreview "*" 
                            Send AddSpacing         to oEditorPreview " "
                            Send AddString          to oEditorPreview '"World!"' 
                            Send AddText            to oEditorPreview ")" 
                            Send AddSpacing         to oEditorPreview " "
                            Send AddOperator        to oEditorPreview ";" 
                            Send AppendTextLn       to oEditorPreview ""
                            Send AddSpacing         to oEditorPreview "        "
                            Send AddKeyword         to oEditorPreview "to"
                            Send AddSpacing         to oEditorPreview " "
                            Send AddText            to oEditorPreview "sRetVal" 
                            Send AppendTextLn       to oEditorPreview ""
                            Send AddSpacing         to oEditorPreview "    "
                            Send AddKeyword         to oEditorPreview "Function_Return"
                            Send AddSpacing         to oEditorPreview " "
                            Send AddText            to oEditorPreview "sRetVal" 
                            Send AppendTextLn       to oEditorPreview "" 
                            Send AddScopeKeyword    to oEditorPreview "End_Function"
                            Send AddSpacing         to oEditorPreview " "
                            Send AddComment         to oEditorPreview "// mFoo"
                            Send AppendTextLn       to oEditorPreview "" 
                            Send AppendTextLn       to oEditorPreview "" 
                            Send AddComment         to oEditorPreview "// Numbers"
                            Send AppendTextLn       to oEditorPreview "" 
                            Send AddKeyword         to oEditorPreview "Number"
                            Send AddSpacing         to oEditorPreview " "
                            Send AddText            to oEditorPreview "nValue" 
                            Send AppendTextLn       to oEditorPreview "" 
                            Send AddKeyword         to oEditorPreview "Move"
                            Send AddSpacing         to oEditorPreview " "
                            Send AddText            to oEditorPreview "(" 
                            Send AddNumber          to oEditorPreview '123' 
                            Send AddText            to oEditorPreview "." 
                            Send AddNumber          to oEditorPreview '45' 
                            Send AddSpacing         to oEditorPreview " "
                            Send AddOperator        to oEditorPreview "+" 
                            Send AddSpacing         to oEditorPreview " "
                            Send AddNumber          to oEditorPreview '67' 
                            Send AddText            to oEditorPreview ")" 
                            Send AddSpacing         to oEditorPreview " "
                            Send AddKeyword         to oEditorPreview "to"
                            Send AddSpacing         to oEditorPreview " "
                            Send AddText            to oEditorPreview "nValue" 
                            //
                            //#IFDEF TH_SCINTILLA
                            Send AppendTextLn       to oEditorPreview ""
                            Send AppendTextLn       to oEditorPreview ""
                            Send AddComment         to oEditorPreview "// Brace highlight"
                            Send AppendTextLn       to oEditorPreview "" 
                            Send AddKeyword         to oEditorPreview "Move"
                            Send AddSpacing         to oEditorPreview " "
                            Send AddText            to oEditorPreview "(" 
                            Send AddNumber          to oEditorPreview "1" 
                            Send AddSpacing         to oEditorPreview " "
                            Send AddOperator        to oEditorPreview "+" 
                            Send AddBraceHLight     to oEditorPreview "(" 
                            Send AddNumber          to oEditorPreview "2" 
                            Send AddSpacing         to oEditorPreview " "
                            Send AddOperator        to oEditorPreview "+" 
                            Send AddSpacing         to oEditorPreview " "
                            Send AddNumber          to oEditorPreview "5" 
                            Send AddBraceHLight     to oEditorPreview ")" 
                            Send AddText            to oEditorPreview ")"
                            Send AddUnmatchedBrace  to oEditorPreview ")"
                            Send AddSpacing         to oEditorPreview " "
                            Send AddKeyword         to oEditorPreview "to"
                            Send AddSpacing         to oEditorPreview " "
                            Send AddText            to oEditorPreview "nValue" 
                            Send AppendTextLn       to oEditorPreview "" 
                            Send AppendTextLn       to oEditorPreview "" 
                            Send AddComment         to oEditorPreview "// Typing string"
                            Send AppendTextLn       to oEditorPreview "" 
                            Send AddKeyword         to oEditorPreview "Move"
                            Send AddSpacing         to oEditorPreview " "
                            Send AddStringTyping    to oEditorPreview '"Typing new string'
                            Send AppendTextLn       to oEditorPreview "" 
                            //#ENDIF
                            //
                            Set TextColor   of oEditorPreview to iOriFore
                            Set Dynamic_Update_State of oEditorPreview to True
                            //
                        End_Procedure

                        Procedure Add_Focus Handle hoParent Returns Integer
                            Integer iRetVal
                            Forward Get Msg_Add_Focus hoParent to iRetVal
                            Send mGeneratePreview
                            Procedure_Return iRetVal
                        End_Procedure
                        
                    End_Object
                    
                End_Object // oColorerPage
                
                Object oKeyboardPage is a TabPage
                    Set Label to "Keyboard"

                    Object oHotKeysGroup is a Group
                        Property Integer piCurrentCommand 0 // command we can customize
                        Set Size to 210 420
                        Set Location to 0 3
                        Set peAnchors to anAll

                        Object oCommands is a TreeView
                            Set Size to 175 120
                            Set Location to 27 10
                            Set Label_Justification_Mode to JMode_Top
                            Set Label_Col_Offset to 2
                            Procedure DoBuildList String sFilter
                                Handle hItem
                                Integer iItem
                                Integer iCount
                                tSciCommandHotKey[] ltCommands
                                Set Dynamic_Update_State to False
                                Send ClearAll
                                Move (Trim(Uppercase(sFilter))) to sFilter
                                Send SortByCommandName of oSciCommandHotKeys
                                Get pCommands of oSciCommandHotKeys to ltCommands
                                Move (SizeOfArray(ltCommands)) to iCount
                                For iItem from 0 to (iCount-1)
                                    If ((sFilter="")or(Uppercase(ltCommands[iItem].sName) contains sFilter)) ;
                                        Get AddTreeItem ltCommands[iItem].sName 0 ltCommands[iItem].iCmd 0 0 to hItem
                                Loop
                                Set Dynamic_Update_State to True
                            End_Procedure
                            Procedure OnCreateTree
                                Send DoBuildList ""
                            End_Procedure
                            Procedure OnItemChanged Handle hItem Handle hItemOld
                                Integer iCmd
                                Get ItemData hItem to iCmd
                                Set piCurrentCommand to iCmd
                                Send DisplayCommandDetails
                                Send ClearKey of oNewKey
                            End_Procedure
                        End_Object

                        Object oTextBox1 is a TextBox
                            Set Auto_Size_State to False
                            Set Size to 10 50
                            Set Location to 7 10
                            Set Label to "Command"
                        End_Object

                        Object oCurrentShortcut is a Form
                            Set Size to 13 200
                            Set Location to 27 140
                            Set Label to "Current Shortcut"
                            Set Label_Justification_Mode to JMode_Top
                            Set Label_Col_Offset to 0
                            Set Enabled_State to False
                        End_Object

                        Object oNewKey is a Form
                            Property tShortCut pNewShortCut
                            Set Size to 13 200
                            Set Location to 67 140
                            Set Label to "New Key Assignment"
                            Set Label_Justification_Mode to JMode_Top
                            Set Label_Col_Offset to 0
                            Set psToolTip to "Type your key assignmet in this field"
                            On_Key Key_F1           Send Default_Key
                            On_Key Key_F4           Send Default_Key
                            On_Key Key_F6           Send Default_Key
                            On_Key Key_F10          Send Default_Key  // <-- clear does not work but not forwarding msg_key helps :)
                            On_Key Key_Shift+Key_F4 Send Default_Key
                            On_Key Key_Shift+Key_F5 Send Default_Key
                            On_Key Key_Shift+Key_F6 Send Default_Key
                            On_Key Key_Shift+Key_F10 Send Default_Key
                            On_Key Key_Ctrl+Key_F4  Send Default_Key
                            On_Key Key_Ctrl+Key_F6  Send Default_Key
                            On_Key Key_Alt+Key_F4   Send Default_Key
                            On_Key Key_Alt+Key_F6   Send Default_Key
                            On_Key Key_Alt+Key_C    Send Default_Key
                            On_Key Key_Alt+Key_O    Send Default_Key
                            On_Key kEnter           Send Default_Key
                            On_Key kNext_Item       Send Default_Key
                            On_Key kPrevious_Item   Send Default_Key
                            Procedure Key Integer iKeyValue Returns Integer
                                Integer iRetval
                                String  sShortCut
                                Integer[] Keys
                                tShortCut NewShortCut
                                Move "" to sShortCut
                                Get ReadKeyboardState   of oSciCommandHotKeys to Keys
                                Get KeysToString        of oSciCommandHotKeys Keys to sShortCut
                                Set Value               of oNewShortcut to sShortCut
                                Move iKeyValue          to NewShortCut.iDFKey
                                Move Keys               to NewShortCut.VKcode
                                Set pNewShortCut        to NewShortCut
                                Send DispatchAnyKey
                                Procedure_Return iRetVal
                            End_Procedure
                            Procedure ClearKey
                                tShortCut EmptyShortCut
                                Set Value to ""
                                Set Value of oNewShortCut to ""
                                Set pNewShortCut to EmptyShortCut
                            End_Procedure
                        End_Object

                        Object oNewShortcut is a Form
                            Set Size to 13 200
                            Set Location to 107 140
                            Set Label to "New Shortcut"
                            Set Label_Justification_Mode to JMode_Top
                            Set Label_Col_Offset to 0
                            Set Enabled_State to False
                        End_Object

                        Object oAssign is a Button
                            Set Location to 27 359
                            Set Label to "Assign"
                            Procedure OnClick
                                Integer iCmd
                                Integer iItem
                                tShortCut ShortCut
                                Get piCurrentCommand to iCmd
                                Get pNewShortCut of oNewKey to ShortCut
                                If (iCmd<>0 and SizeOfArray(ShortCut.VKcode)>0) Begin
                                    Send AssignShortCutToCmd of oSciCommandHotKeys iCmd ShortCut
                                    Send DisplayCommandDetails
                                    Send Activate to oNewKey
                                    Delegate Send NotifyChange
                                End
                            End_Procedure
                        End_Object

                        Object oRemove is a Button
                            Set Location to 44 359
                            Set Label to "Remove"
                            Procedure OnClick
                                Integer iCmd
                                Integer iItem
                                Get piCurrentCommand to iCmd
                                If (iCmd<>0) Begin
                                    Send RemoveShortCutFromCmd of oSciCommandHotKeys iCmd
                                    Send DisplayCommandDetails
                                    Send Activate to oNewKey
                                    Delegate Send NotifyChange
                                End
                            End_Procedure
                        End_Object
                        
                        Object oCommandHelpTb is a cTextEdit
                            Set Size to 40 200
                            Set Location to 162 140
                            Set Enabled_State to False
                        End_Object

                        Object oSearch is a Form
                            Set Size to 11 120
                            Set Location to 16 10
                            On_Key Key_Down_Arrow Send Activate to oCommands
                            On_Key Key_Tab        Send Activate to oCommands
                            Procedure OnChange
                                String sValue
                                Get Value to sValue
                                Set Color to clWindow
                                If (sValue<>"") Set Color to (RGB(255,200,200))
                                Send DoBuildList to oCommands sValue
                            End_Procedure
                        End_Object

                        Procedure DisplayCommandDetails
                            Boolean bHasHotKey
                            Integer iCmd
                            String  sDescription
                            String  sShortCut
                            tSciCommandHotKey Command
                            Move "" to sDescription
                            Send Delete_Data of oCommandHelpTb
                            Set Value of oCurrentShortcut to ""
                            //
                            Get piCurrentCommand to iCmd
                            If (iCmd<>0) Begin
                                Get FindCommand of oSciCommandHotKeys iCmd to Command
                                If (Command.iCmd=iCmd) Begin
                                    Send AppendTextLn of oCommandHelpTb Command.sDescription
                                End
                                Get CommandHasHotKey of oSciCommandHotKeys Command to bHasHotKey
                                If (bHasHotKey) Begin
                                    Get CommandHotKeyString of oSciCommandHotKeys Command to sShortCut
                                    Set Value of oCurrentShortCut to sShortCut
                                End
                            End
                        End_Procedure
                        
                    End_Object // oFilesGrp

                End_Object // oKeyboardPage

                Object oWindowPage is a TabPage
                    Set Label to "Window"

                    Object oAppearanceGrp is a Group
                        Set Size to 79 420
                        Set Location to 0 3
                        Set peAnchors to anAll
                        Set Label to "Appearance"

                        Object oUseSkin is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 11 30
                            Set Label to "Use Skins"
                            // Skin does not work well, so keeping this off for the moment
                            Set Enabled_State to False
                            Procedure OnChange
                                Boolean bChecked
                                Get Checked_State to bChecked
                                Set Enabled_State of oSkins to bChecked
                            End_Procedure
                        End_Object

                        Object oSkins is a cNotifierComboForm
                            Set Size to 13 150
                            Set Location to 10 75
                            Procedure Combo_Fill_List
                                Integer iSkin iSkinsCount
                                tSkinInformation[] ltSkins
                                If ghoSkinFramework Begin
                                    Get EnumerateSkins of ghoSkinFramework "" True to ltSkins
                                    Move (SizeOfArray(ltSkins)) to iSkinsCount
                                    Send Delete_Data
                                    For iSkin from 0 to (iSkinsCount-1)
                                        Send Combo_Add_Item (ltSkins[iSkin].sSkinfile * "-" * ltSkins[iSkin].sSkinIni)
                                    Loop
                                End
                                Set Value item 0 to (psCurrentSkinFile(ghoEditorProperties) * "-" * psCurrentSkinIni(ghoEditorProperties))
                            End_Procedure
                        End_Object

                        Object oTabsLocation is a cNotifierComboForm
                            Set Size to 13 70
                            Set Location to 26 75
                            Set Label to "File Tabs Location"
                            Procedure Combo_Fill_List
                                String sLocation
                                Send Combo_Add_Item "Top"
                                Send Combo_Add_Item "Bottom"
                                Move (psFileTabsLocation(ghoEditorProperties)) to sLocation
                                If (sLocation="") Move "Bottom" to sLocation
                                Set Value item 0 to sLocation
                                Set Entry_State to False
                            End_Procedure
                        End_Object
                        
                        Object oTabsAppearance is a cNotifierComboForm
                            Set Size to 13 70
                            Set Location to 42 75
                            Set Label to "File Tabs Appearance"
                            Procedure Combo_Fill_List
                                String sOption
                                Send Combo_Add_Item "PROPERTY"
                                Send Combo_Add_Item "PROPERTY2003"
                                Send Combo_Add_Item "PROPERTYFLAT"
                                Send Combo_Add_Item "STATEBUTTON"
                                Send Combo_Add_Item "EXCEL2003"
                                Send Combo_Add_Item "FLAT"
                                Send Combo_Add_Item "OFFICE2013"
                                Send Combo_Add_Item "VS"
                                Send Combo_Add_Item "VS2003"
                                Send Combo_Add_Item "VS2005"
                                Send Combo_Add_Item "VS2010"
                                Send Combo_Add_Item "VS2012"
                                Move (psFileTabsAppearance(ghoEditorProperties)) to sOption
                                If (sOption="") Move "EXCEL2003" to sOption
                                Set Value item 0 to sOption
                                Set Entry_State to False
                            End_Procedure
                        End_Object

                        Object oTabsColor is a cNotifierComboForm
                            Set Size to 13 70
                            Set Location to 58 75
                            Set Label to "File Tabs Color"
                            Procedure Combo_Fill_List
                                String sOption
                                Send Combo_Add_Item "DEFAULT"
                                Send Combo_Add_Item "OFFICE2003"
                                Send Combo_Add_Item "NATIVE"
                                Send Combo_Add_Item "RESOURCE"
                                Send Combo_Add_Item "VS"
                                Send Combo_Add_Item "VS2003"
                                Send Combo_Add_Item "VS2005"
                                Send Combo_Add_Item "VS2006"
                                Send Combo_Add_Item "VS2019"
                                Send Combo_Add_Item "VS2012"
                                Send Combo_Add_Item "VS2012DK"
                                Send Combo_Add_Item "OACCESS2007"
                                Send Combo_Add_Item "OFFICE2007"
                                Send Combo_Add_Item "OFFICE2013"
                                Send Combo_Add_Item "ALL"
                                Send Combo_Add_Item "WINXP"
                                Send Combo_Add_Item "WHIDBEY"
                                Send Combo_Add_Item "ACCESS2007"
                                Move (psFileTabsColor(ghoEditorProperties)) to sOption
                                If (sOption="") Move "DEFAULT" to sOption
                                Set Value item 0 to sOption
                                Set Entry_State to False
                            End_Procedure
                        End_Object
                    End_Object

                    Object oOptionsGrp is a Group
                        Set Size to 132 420
                        Set Location to 79 3
                        Set peAnchors to anAll
                        Set Label to "Options"

                        Object oLineNumbers is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 10 75
                            Set Label to "Show Line Numbers"
                        End_Object

                        Object oScopeMargin is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 26 75
                            Set Label to "Show Scope Blocks Margin"
                        End_Object

                        Object oIndent is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 42 75
                            Set Label to "Auto Indent"
                        End_Object

                        Object oGuides is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 58 75
                            Set Label to "Show Indentation Guides"
                        End_Object

                        Object oBraces is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 74 75
                            Set Label to "Show Matching Braces"
                        End_Object

                        Object oTabs is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 10 250
                            Set Label to "Convert Tabs to Spaces (Size:"
                        End_Object

                        Object oTabSize is a cNotifierSpinForm
                            Set Size to 13 30
                            Set Location to 8 351
                            Set Status_Help to "Number of spaces to replace TAB character"
                        End_Object

                        Object oTextBox2 is a TextBox
                            Set Auto_Size_State to False
                            Set Size to 10 17
                            Set Location to 10 385
                            Set Label to ")"
                        End_Object

                        Object oSelect is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 90 75
                            Set Label to "Highlight whole line on selection"
                        End_Object
                    End_Object
                End_Object // oWindowPage

            End_Object // oEditorTabDialog

            Procedure SaveEntries
                Integer iCount iC iCount2
                String  sExt sLang sSkin sSkinName
                String  sHotKey

                Set psFileTypes                 of ghoEditorProperties   to (GetValue(oOpenFiles(Self)))
                Set piRecentFilesLimit          of ghoEditorProperties   to (Value(oRecentFiles(Self),0))
                Set piRecentWSLimit             of ghoEditorProperties   to (Value(oRecentWorkspaces(Self),0))
                Set psLanguage                  of ghoEditorProperties   to (Value(oLanguage(Self),0))

                // CodeTip/CodeList
                Set pbCodeListUseBitmaps        of ghoEditorProperties   to (Checked_State(oBitmaps(Self)))
                Set pbUseCodeTips               of ghoEditorProperties   to (Checked_State(oCodeTips(Self)))
                Set pbCodeTipAutoPopup          of ghoEditorProperties   to (Checked_State(oCodeTipPopup(Self)))
                Set psCodeTipIniFile            of ghoEditorProperties   to (Value(oFunctionsINI(Self),0))
                Set psTokensIniFile             of ghoEditorProperties   to (Value(oTokensINI(Self),0))

                // Code Lists Auto Popup
                Set pbShowClasses               of ghoEditorProperties   to (Checked_State(oClasses(Self)))
                Set pbShowObjects               of ghoEditorProperties   to (Checked_State(oObjects(Self)))
                Set pbShowMethods               of ghoEditorProperties   to (Checked_State(oMethods(Self)))
                Set pbShowKeys                  of ghoEditorProperties   to (Checked_State(oKeys(Self)))
                Set pbShowFields                of ghoEditorProperties   to (Checked_State(oFields(Self)))
                Set pbShowIndexes               of ghoEditorProperties   to (Checked_State(oIndexes(Self)))
                Set pbShowVariables             of ghoEditorProperties   to (Checked_State(oVariables(Self)))

                Set pbShowStructures            of ghoEditorProperties   to (Checked_State(oStructures(Self)))
                Set pbShowIDETags               of ghoEditorProperties   to (Checked_State(oTags(Self)))
                Set pbShowCommands              of ghoEditorProperties   to (Checked_State(oCommands(Self)))
                Set pbShowTypes                 of ghoEditorProperties   to (Checked_State(oTypes(Self)))
                Set pbShowAttributes            of ghoEditorProperties   to (Checked_State(oAttributes(Self)))

                // *** Skins
                Set piUseSkins                  of ghoEditorProperties   to (Checked_State(oUseSkin(Self)))
                Get Value of oSkins to sSkin
                Move (Left(sSkin, Pos('-', sSkin)))     to sSkinName
                Move (Replace(sSkinName, sSkin, ""))    to sSkin
                Move (Replace('-', sSkinName, ""))      to sSkinName
                Set psCurrentSkinFile           of ghoEditorProperties   to (Trim(sSkinName))
                Set psCurrentSkinIni            of ghoEditorProperties   to (Trim(sSkin))
                // *** File tabs
                Set psFileTabsLocation          of ghoEditorProperties   to (Value(oTabsLocation(Self), 0))
                Set psFileTabsAppearance        of ghoEditorProperties   to (Value(oTabsAppearance(Self), 0))
                Set psFileTabsColor             of ghoEditorProperties   to (Value(oTabsColor(Self), 0))

                // *** Hot keys
                Get ShortCutKeyDefinitions      of oSciCommandHotKeys    to sHotKey
                Set psEditorHotKeys             of ghoEditorProperties   to sHotKey

                // Options
                Set piLineNumbering             of ghoEditorProperties   to (Checked_State(oLineNumbers(Self)))
                Set pbLeftMargin                of ghoEditorProperties   to (Checked_State(oScopeMargin(Self)))
                Set piAutoIndentMode            of ghoEditorProperties   to (Checked_State(oIndent(Self)))
                Set pbShowMatchingBraces        of ghoEditorProperties   to (Checked_State(oBraces(Self)))
                Set pbShowIndentGuides          of ghoEditorProperties   to (Checked_State(oGuides(Self)))
                Set pbSelectWholeLine           of ghoEditorProperties   to (Checked_State(oSelect(Self)))
                Set pbTabExpand                 of ghoEditorProperties   to (Checked_State(oTabs(Self)))
                Set piTabSize                   of ghoEditorProperties   to (Value(oTabSize(Self),0))

                // *** Language Assign
                Get Item_Count of (oAssignFiles(Self)) to iCount
                Send psLangAssign.DeleteAllItems to ghoEditorProperties
                For iC from 0 to (iCount-1)
                    Get value of (oAssignFiles(Self)) item iC      to sLang
                    Get value of (oAssignFiles(Self)) item (iC+1)  to sExt
                    If ((sExt<>"")and(sLang<>"")) Begin
                        Get psLangAssign.Count       of ghoEditorProperties  to iCount2
                        Set psLangAssign.Ext         of ghoEditorProperties  item iCount2 to sExt
                        Set psLangAssign.Language    of ghoEditorProperties  item iCount2 to sLang
                    End
                    Increment iC
                End
                
                // *** Color Schemas
                String  sSchemaName sColors sFontStyles
                Get psColors of ghoEditorProperties to sColors
                // Re-format to support Scintilla
                If (Length(sColors)=CM_COLORS_STRSIZE) ;
                    Move (sColors + Repeat('0', SC_COLORS_STRSIZE-CM_COLORS_STRSIZE)) to sColors
                Get CurrentColors           to sColors
                Get CurrentFontStyles       to sFontStyles
                Get Value of oSchemaSelect  to sSchemaName
                If (sSchemaName<>"") Begin
                    If ((sSchemaName<>TH_DEFSCHEMA_BLACK_STR)and(sSchemaName<>TH_DEFSCHEMA_WHITE_STR)and(sSchemaName<>TH_DEFSCHEMA_BLUE_STR)) Begin
                        Get FindColorSchema of ghoEditorProperties sSchemaName                  to iC
                        If (iC<0) Get psColorSchemas.Count      of ghoEditorProperties          to iC
                        Set psColorSchemas                      of ghoEditorProperties item iC  to sSchemaName
                        Set psColorSchemas.psSchemaColors       of ghoEditorProperties item iC  to sColors
                        Set psColorSchemas.psSchemaFontStyles   of ghoEditorProperties item iC  to sFontStyles
                    End
                    Set psColorSchema  of ghoEditorProperties                   to sSchemaName
                    Set psColors       of ghoEditorProperties                   to sColors
                    Set psFontStyles   of ghoEditorProperties                   to sFontStyles
                End
                //
                String sFontFace
                Get Value of oFontFace item 0 to sFontFace
                If (sFontFace="") Move "11pt; 0; Courier New" to sFontFace
                Set psFontFace     of ghoEditorProperties   to sFontFace
            End_Procedure
            
            Procedure LoadEntries
                Integer iCount iC
                
                // oFilesPage
                Send SetValue      of oOpenFiles           (psFileTypes(ghoEditorProperties)) 
                Set  Value         of oRecentFiles      to (piRecentFilesLimit(ghoEditorProperties))
                Set  Value         of oRecentWorkspaces to (piRecentWSLimit(ghoEditorProperties))

                Set  Value         of oLanguage        to (psLanguage(ghoEditorProperties))

                // CodeTip/CodeList
                Set Checked_State  of oBitmaps         to (pbCodeListUseBitmaps(ghoEditorProperties))
                Set Checked_State  of oCodeTips        to (pbUseCodeTips(ghoEditorProperties))
                Set Checked_State  of oCodeTipPopup    to (pbCodeTipAutoPopup(ghoEditorProperties))
                Set Value          of oFunctionsINI    to (psCodeTipIniFile(ghoEditorProperties))
                Set Value          of oTokensINI       to (psTokensIniFile(ghoEditorProperties))

                // Code Lists Auto Popups
                Set Checked_State  of oClasses         to (pbShowClasses(ghoEditorProperties))
                Set Checked_State  of oObjects         to (pbShowObjects(ghoEditorProperties))
                Set Checked_State  of oMethods         to (pbShowMethods(ghoEditorProperties))
                Set Checked_State  of oKeys            to (pbShowKeys(ghoEditorProperties))
                Set Checked_State  of oFields          to (pbShowFields(ghoEditorProperties))
                Set Checked_State  of oIndexes         to (pbShowIndexes(ghoEditorProperties))
                Set Checked_State  of oVariables       to (pbShowVariables(ghoEditorProperties))
                Set Checked_State  of oStructures      to (pbShowStructures(ghoEditorProperties))
                Set Checked_State  of oTags            to (pbShowIDETags(ghoEditorProperties))
                Set Checked_State  of oCommands        to (pbShowCommands(ghoEditorProperties))
                Set Checked_State  of oTypes           to (pbShowTypes(ghoEditorProperties))
                Set Checked_State  of oAttributes      to (pbShowAttributes(ghoEditorProperties))

                // Skins
                Set Checked_State  of oUseSkin         to (piUseSkins(ghoEditorProperties))
                Set Enabled_State  of oSkins           to (piUseSkins(ghoEditorProperties))
                If (piUseSkins(ghoEditorProperties)) 
                Set Value          of oSkins item 0    to (psCurrentSkinFile(ghoEditorProperties) * "-" * psCurrentSkinIni(ghoEditorProperties))
                // Tabs
                Set Value          of oTabsLocation   item 0 to (psFileTabsLocation(ghoEditorProperties))
                Set Value          of oTabsAppearance item 0 to (psFileTabsAppearance(ghoEditorProperties))
                Set Value          of oTabsColor      item 0 to (psFileTabsColor(ghoEditorProperties))
                // Options
                Set Checked_State  of oLineNumbers     to (piLineNumbering(ghoEditorProperties))
                Set Checked_State  of oScopeMargin     to (pbLeftMargin(ghoEditorProperties))
                Set Checked_State  of oIndent          to (piAutoIndentMode(ghoEditorProperties))
                Set Checked_State  of oBraces          to (pbShowMatchingBraces(ghoEditorProperties))
                Set Checked_State  of oGuides          to (pbShowIndentGuides(ghoEditorProperties))
                Set Checked_State  of oSelect          to (pbSelectWholeLine(ghoEditorProperties))

                Set Checked_State  of oTabs            to (pbTabExpand(ghoEditorProperties))
                Set Value          of oTabSize         to (piTabSize(ghoEditorProperties))
                //
                Send Delete_Data   to oAssignFiles
                Get psLangAssign.Count       of ghoEditorProperties     to iCount
                For iC from 0 to (iCount-1)
                    Send Add_New_Line to oAssignFiles ;
                                (psLangAssign.Language(ghoEditorProperties,iC)) ;
                                (psLangAssign.Ext(ghoEditorProperties,iC)) ;
                                0
                End
                //
                String sFontFace
                Move (psFontFace(ghoEditorProperties)) to sFontFace
                If (sFontFace="") Move "11pt; 0; Courier New" to sFontFace
                Set Value          of oFontFace       item 0 to sFontFace
            End_Procedure
            
        End_Object // oEditorPage

        Object oBuildPage is a TabPage
            Set Label to "&2. Build"
            Set piImageIndex to 1

            Object oGeneralGroup is a Group
                Set Size to 26 423
                Set Location to 2 5
                Set Label to "General"

                Object oUseWorkspace is a cNotifierCheckBox
                    Set Size to 10 50
                    Set Location to 10 75
                    Set Label to "Use Workspaces"
                End_Object

                Object oDisplayMsg is a cNotifierCheckBox
                    Set Size to 10 50
                    Set Location to 10 146
                    Set Label to "Display Compiler Messages"
                    Procedure select_toggling Integer iItem Integer iSelect
                        Forward Send select_toggling iItem iSelect
                        Send Info_box "You have to restart the Program to activate/deactivate this Option!" "Information"
                    End_Procedure
                    Procedure OnChange
                        Forward Send OnChange
                        Set enabled_state of oHideMsg to (checked_state(Self))
                    End_Procedure
                End_Object

                Object oHideMsg is a cNotifierCheckBox
                    Set Size to 10 50
                    Set Location to 10 250
                    Set Label to "Display/Hide Compiler Messages automatically"
                End_Object
            End_Object

            Object oBuildGroup is a Group
                Set Size to 137 423
                Set Location to 28 5
                Set Label to "Build"

                Object oCompilerCmd is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 10 75
                    Set Label to "Compiler Command"
                    Set Status_Help To "Command line to be used to start compiler"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 10 366
                    Set Size to 13 50
                    Set psFileDialogCaption to "Select Project Compiler"
                    Set phoPathForm to (oCompilerCmd(Self))
                End_Object

                Object oCompileOptions is a cNotifierForm
                    Set Size to 13 100
                    Set Location to 26 75
                    Set Label to "Compile Options"
                    Set Status_Help To "Compiler options on startup"
                End_Object

                Object oPreCompileOptions is a cNotifierForm
                    Set Size to 13 100
                    Set Location to 26 260
                    Set Label to "Pre-compile Options"
                    Set Status_Help To "Pre-compile options for headers compilation"
                End_Object

                Object oShowErrorPane is a cNotifierCheckBox
                    Set Size to 10 50
                    Set Location to 42 76
                    Set Label to "Show Error Message Pane"
                    Set Status_Help To "Will show Errors list in the TH Message Area (if case)"
                End_Object

                Object oDebuggerCmd is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 74 75
                    Set Label to "Debugger Command"
                    Set Status_Help to "Command line to be used to start debugger (if applicable)"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 74 366
                    Set Size to 13 50
                    Set psFileDialogCaption to "Select Project Debugger"
                    Set phoPathForm to (oDebuggerCmd(Self))
                End_Object

                Object oDebugOptions is a cNotifierForm
                    Set Size to 13 100
                    Set Location to 90 75
                    Set Label to "Compile Options"
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to JMode_Right
                End_Object

                Object oDebugRecompile is a cNotifierCheckBox
                    Set Size to 10 50
                    Set Location to 106 76
                    Set Label to "Re-compile Before Debugging"
                End_Object

                Object oDebugStart is a cNotifierCheckBox
                    Set Size to 10 50
                    Set Location to 122 76
                    Set Label to "Always Start with Debugger"
                End_Object

                Object oLineControl1 is a LineControl
                    Set Size to 2 340
                    Set Location to 62 75
                End_Object

                Object oExtCompilerOnly is a cNotifierCheckBox
                    Set Size to 10 50
                    Set Location to 42 260
                    Set Label to "External compiler only"
                    Set Status_Help to "If enabled, The Hammer will not try to use intergrated compiler for DataFlex"
                    Procedure onChange
                        Forward Send onChange
                        Integer iChecked
                        Get Checked_State to iChecked
                        Set Enabled_State of oCompilersBtn to (not(iChecked))
                    End_Procedure
                End_Object

                Object oCompilersBtn is a Button
                    Set Location to 39 366
                    Set Label to "Compilers"
                    Set Enabled_State of oCompilersBtn to (pbExtCompilerOnly(ghoEditorProperties)=0)
                
                    // fires when the button is clicked
                    Procedure OnClick
                        Send Popup to oCompilers_SL
                    End_Procedure
                
                End_Object
                
            End_Object

            Object oExecuteGroup is a Group
                Set Size to 64 423
                Set Location to 165 5
                Set Label to "Execute"

                Object oRuntimeCmd is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 10 75
                    Set Label to "Runtime Command"
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to JMode_Right
                    Set Status_Help to "Runtime engine for the older DataFlex applications"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 10 366
                    Set Size to 13 50
                    Set psFileDialogCaption to "Select Runtime Engine"
                    Set phoPathForm to (oRuntimeCmd(Self))
                End_Object

                Object oSignCmd is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 26 75
                    Set Label to "Sign DataFlex Project"
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to JMode_Right
                    Set Status_Help to "Requires project EXE name path and SWS file path as parameters"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 26 366
                    Set Size to 13 50
                    Set psFileDialogCaption to "Select Project Sign Application"
                    Set phoPathForm to (oSignCmd(Self))
                End_Object

            End_Object

            Procedure SaveEntries
                Set piUseWorkSpace              of ghoEditorProperties          to (Checked_State(oUseWorkspace(Self)))
                Set piWatchCompiler             of ghoEditorProperties          to (Checked_State(oDisplayMsg(Self)))
                Set piDisplayWatchAutomatic     of ghoEditorProperties          to (Checked_State(oHideMsg(Self)))
                Set psCompiler                  of ghoEditorProperties          to (Value(oCompilerCmd(Self),0))
                Set psCompiler.CompOptions      of ghoEditorProperties          to (Value(oCompileOptions(Self),0))
                Set psCompiler.PreCompOptions   of ghoEditorProperties          to (Value(oPreCompileOptions(Self),0))
                Set piCompileShowErrorMsg       of ghoEditorProperties          to (Checked_State(oShowErrorPane(Self)))
                Set psDebugger                  of ghoEditorProperties          to (Value(oDebuggerCmd(Self),0))
                Set psDebugCompiler             of ghoEditorProperties          to (Value(oDebugOptions(Self),0))
                Set piCompiler4Debug            of ghoEditorProperties          to (Checked_State(oDebugRecompile(Self)))
                Set piDebugAlways               of ghoEditorProperties          to (Checked_State(oDebugStart(Self)))
                Set psDfrun                     of ghoEditorProperties          to (Value(oRuntimeCmd(Self),0))
                Set psSignAppPath               of ghoEditorProperties          to (Value(oSignCmd(Self),0))
                Set pbExtCompilerOnly           of ghoEditorProperties          to (Checked_State(oExtCompilerOnly(Self)))
            End_Procedure

            Procedure LoadEntries
                Set Checked_State               of (oUseWorkspace(Self))        to (piUseWorkSpace(ghoEditorProperties))
                Set Checked_State               of (oDisplayMsg(Self))          to (piWatchCompiler(ghoEditorProperties))
                Set Checked_State               of (oHideMsg(Self))             to (piDisplayWatchAutomatic(ghoEditorProperties))
                Set Value                       of (oCompilerCmd(Self))         to (psCompiler(ghoEditorProperties))
                Set Value                       of (oCompileOptions(Self))      to (psCompiler.CompOptions(ghoEditorProperties))
                Set Value                       of (oPreCompileOptions(Self))   to (psCompiler.PreCompOptions(ghoEditorProperties))
                Set Checked_State               of (oShowErrorPane(Self))       to (piCompileShowErrorMsg(ghoEditorProperties))
                Set Value                       of (oDebuggerCmd(Self))         to (psDebugger(ghoEditorProperties))
                Set Value                       of (oDebugOptions(Self))        to (psDebugCompiler(ghoEditorProperties))
                Set Checked_State               of (oDebugRecompile(Self))      to (piCompiler4Debug(ghoEditorProperties))
                Set Checked_State               of (oDebugStart(Self))          to (piDebugAlways(ghoEditorProperties))
                Set Value                       of (oRuntimeCmd(Self))          to (psDfrun(ghoEditorProperties))
                Set Value                       of (oSignCmd(Self))             to (psSignAppPath(ghoEditorProperties))
                Set Checked_State               of (oExtCompilerOnly(Self))     to (pbExtCompilerOnly(ghoEditorProperties))
            End_Procedure
            
        End_Object // oBuildPage

        Object oSourcePage is a TabPage
            Set Label to "&3. Source"
            Set piImageIndex to 2

            Object oStudioGroup is a Group
                Set Size to 35 423
                Set Location to 2 5
                Set Label to "Studio / IDE"
                Object oStudioCmd is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 10 75
                    Set Label to "Command Line"
                    Set Status_Help to "Please specify Code Art Utility full qualified path"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 10 366
                    Set psFileDialogCaption to "Select the Studio / IDE"
                    Set phoPathForm to (oStudioCmd(Self))
                End_Object
            End_Object

            Object oCodeArtGroup is a Group
                Set Size to 35 423
                Set Location to 38 5
                Set Label to "Code Art Utility"
                Object oCodeArtCmd is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 10 75
                    Set Label to "Command Line"
                    Set Status_Help to "Please specify Code Art Utility full qualified path"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 10 366
                    Set psFileDialogCaption to "Select the Code Art Utility"
                    Set phoPathForm to (oCodeArtCmd(Self))
                End_Object
            End_Object

            Object oCodeSpyGroup is a Group
                Set Size to 35 423
                Set Location to 75 5
                Set Label to "Code Spy Utility"
                Object oCodeSpyCmd is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 10 75
                    Set Label to "Command Line"
                    Set Status_Help to "Please specify Code Spy Utility full qualified path"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 10 366
                    Set psFileDialogCaption to "Select the Code Spy Utility"
                    Set phoPathForm to (oCodeSpyCmd(Self))
                End_Object
            End_Object

            Object oCodeMergeGroup is a Group
                Set Size to 35 423
                Set Location to 111 5
                Set Label to "Code Merge Utility"
                Object oCodeMergeCmd is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 10 75
                    Set Label to "Command Line"
                    Set Status_Help to "Please specify Code Merge Utility full qualified path"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 10 366
                    Set psFileDialogCaption to "Select the Code Merge Utility"
                    Set phoPathForm to (oCodeMergeCmd(Self))
                End_Object
            End_Object

            Object oVCSGroup is a Group
                Set Size to 35 423
                Set Location to 148 5
                Set Label to "Version Control System"
                Object oVCSCmd is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 10 75
                    Set Label to "Command Line"
                    Set Status_Help to "Please specify Version Control System full qualified path"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 10 366
                    Set psFileDialogCaption to "Select the Version Control System"
                    Set phoPathForm to (oVCSCmd(Self))
                End_Object
            End_Object

            Object oCodePublishGroup is a Group
                Set Size to 35 423
                Set Location to 186 5
                Set Label to "Code Publishing Tool"
                Object oCodePublishCmd is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 10 75
                    Set Label to "Command Line"
                    Set Status_Help to "Please specify Code Publishing Utility full qualified path"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 10 366
                    Set psFileDialogCaption to "Select the Code Publishing Utility"
                    Set phoPathForm to (oCodePublishCmd(Self))
                End_Object
            End_Object
            
            Procedure SaveEntries
                Set psIdePath       of ghoEditorProperties  to (Value(oStudioCmd(Self),0))
                Set psMergePath     of ghoEditorProperties  to (Value(oCodeMergeCmd(Self),0))
                Set psVcsPath       of ghoEditorProperties  to (Value(oVCSCmd(Self),0))
                Set psCodeArtPath   of ghoEditorProperties  to (Value(oCodeArtCmd(Self),0))
                Set psCodeSpyPath   of ghoEditorProperties  to (Value(oCodeSpyCmd(Self),0))
                Set psCodePubPath   of ghoEditorProperties  to (Value(oCodePublishCmd(Self),0))
            End_Procedure

            Procedure LoadEntries
                Set Value           of oStudioCmd           to (psIdePath(ghoEditorProperties))
                Set Value           of oCodeMergeCmd        to (psMergePath(ghoEditorProperties))
                Set Value           of oVCSCmd              to (psVcsPath(ghoEditorProperties))
                Set Value           of oCodeArtCmd          to (psCodeArtPath(ghoEditorProperties))
                Set Value           of oCodeSpyCmd          to (psCodeSpyPath(ghoEditorProperties))
                Set Value           of oCodePublishCmd      to (psCodePubPath(ghoEditorProperties))
            End_Procedure
            
            
        End_Object // oSourcePage

        Object oDatabasePage is a TabPage
            Set Label to "&4. Database"
            Set piImageIndex to 3

            Object oOpenDialog is a OpenDialog
                Set Location to 170 379
                Set Dialog_Caption to "Select a file"
                Set Filter_String to "Executables|*.exe|All Files|*.*"
                Set NoChangeDir_State   to True
            End_Object    // oOpenDialog

            Object oDBEditorGroup is a Group
                Set Size to 44 423
                Set Location to 2 5
                Set Label to "Database Editor"
                Object oDBEditorCmd is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 10 75
                    Set Label to "Command Line"
                    Set Status_Help to "Please specify Database Editor full qualified path (You may use @VDFROOT@ macro)"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 10 366
                    Set psFileDialogCaption to "Select the Database Editor Utility"
                    Set phoPathForm to (oDBEditorCmd(Self))
                End_Object
            End_Object
            Object oDBVIewerGroup is a Group
                Set Size to 44 423
                Set Location to 46 5
                Set Label to "Database Viewer"
                Object oDBViewerCmd is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 10 75
                    Set Label to "Command Line"
                    Set Status_Help to "Please specify Database Viewer full qualified path (You may use @VDFROOT@ macro)"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 10 366
                    Set psFileDialogCaption to "Select the Database Viewer Utility"
                    Set phoPathForm to (oDBViewerCmd(Self))
                End_Object
            End_Object
            Object oDBCompareGroup is a Group
                Set Size to 44 423
                Set Location to 91 5
                Set Label to "Database Compare Utility"
                Object oDBCompareCmd is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 10 75
                    Set Status_Help to "Please specify Database Compare Utility full qualified path"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 10 366
                    Set psFileDialogCaption to "Select the Database Compare Utility"
                    Set phoPathForm to (oDBCompareCmd(Self))
                End_Object
            End_Object
            Object oDBUpdateGroup is a Group
                Set Size to 44 423
                Set Location to 136 5
                Set Label to "Database Update Utility"
                Object oDBUpdateCmd is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 10 75
                    Set Label to "Command Line"
                    Set Status_Help to "Please specify Database Update Utility full qualified path"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 10 366
                    Set psFileDialogCaption to "Select the Database Update Utility"
                    Set phoPathForm to (oDBUpdateCmd(Self))
                End_Object
            End_Object
            Object oReportingGroup is a Group
                Set Size to 44 423
                Set Location to 181 5
                Set Label to "Report Writer"
                Object oReportCmd is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 10 75
                    Set Label to "Command Line"
                    Set Status_Help to "Please specify Report Writer full qualified path"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 10 366
                    Set psFileDialogCaption to "Select the Report Writer"
                    Set phoPathForm to (oDBUpdateCmd(Self))
                End_Object
            End_Object
            
            Procedure SaveEntries
                Set psDBBPath       of ghoEditorProperties  to (Value(oDBEditorCmd(Self),0))
                Set psDBEPath       of ghoEditorProperties  to (Value(oDBViewerCmd(Self),0))
                Set psRptPath       of ghoEditorProperties  to (Value(oReportCmd(Self),0))
                Set psDBCPath       of ghoEditorProperties  to (Value(oDBCompareCmd(Self),0))
                Set psDBUPath       of ghoEditorProperties  to (Value(oDBUpdateCmd(Self),0))
            End_Procedure

            Procedure LoadEntries
                Set Value           of oDBEditorCmd         to (psDbbPath(ghoEditorProperties))
                Set Value           of oDBViewerCmd         to (psDbePath(ghoEditorProperties))
                Set Value           of oReportCmd           to (psRptPath(ghoEditorProperties))
                Set Value           of oDBCompareCmd        to (psDbcPath(ghoEditorProperties))
                Set Value           of oDBUpdateCmd         to (psDbuPath(ghoEditorProperties))
            End_Procedure
            
        End_Object // oDatabasePage

        Object oUtilityPage is a TabPage
            Set Label to "&5. Utilities"
            Set piImageIndex to 4

            Object oCodeArtGroup is a Group
                Set Size to 59 423
                Set Location to 2 5
                Set Label to "Code Art (Built-in Utility)"
                Set Enabled_State to (psCodeArtPath(ghoEditorProperties)="")

                Object oComments is a cNotifierCheckBox
                    Set Size to 10 50
                    Set Location to 10 75
                    Set Label to 'Insert comments followed by the end of the current scope'
                End_Object

                Object oDate is a cNotifierCheckBox
                    Set Size to 10 50
                    Set Location to 26 75
                    Set Label to 'Insert Date/Time stamp at the top of the formatted source'
                End_Object

                Object oWarnings is a cNotifierCheckBox
                    Set Size to 10 50
                    Set Location to 42 75
                    Set Label to 'Insert CodeArt warnings into the formatted source'
                End_Object

            End_Object // oCodeArtGroup

            Object oCodePublishGroup is a Group
                Set Size to 65 423
                Set Location to 61 5
                Set Label to "Code Publishing (HTML Built-in Utility)"
                Set Enabled_State to (psCodePubPath(ghoEditorProperties)="")

                Object oOpenDialog is a OpenDialog
                    Set Location to 170 379
                    Set Dialog_Caption to "Select a file"
                    Set Filter_String to "Hyper Text Markup|*.html;*.htm|Template|*.tpl|All Files|*.*"
                    Set NoChangeDir_State   to True
                End_Object    // oOpenDialog

                Object oHeaderFile is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 10 75
                    Set Label to "Header File"
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to JMode_Right
                    Set Status_Help to "Select HTML Header file to be included (<HTML>...<BODY>...)"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 10 366
                    Set psFileDialogCaption to "Select the Header File"
                    Set phoPathForm to (oHeaderFile(Self))
                End_Object

                Object oFooterFile is a cNotifierForm
                    Set Size to 13 285
                    Set Location to 26 75
                    Set Label to "Footer File"
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to JMode_Right
                    Set Status_Help to "Select HTML Footer file to be included (...</BODY></HTML>)"
                End_Object
                Object oBrowse is a cCmdLineSelector
                    Set Location to 26 366
                    Set psFileDialogCaption to "Select the Footer File"
                    Set phoPathForm to (oHeaderFile(Self))
                End_Object

            End_Object

            Object oTranslateGroup is a Group
                Set Size to 100 423
                Set Location to 126 5
                Set Label to "Character Translation"

                Object oTranslate is a cTHWSGrid
                    Property String  psSepCharacter  Public "|"
                    Set Size to 83 125
                    Set Location to 10 75
                    Set Line_Width      to 1 0
                    Set Form_Width      0 to 120
                    Set Header_Label    0 to "Character Translation"
                    Set Status_Help item 0 to ""
                    On_Key key_F2 Send Request_SaveAllEntries
                    On_Key kCancel Send Close_Panel
                    Procedure OnChange Integer iItem
                        Delegate Send NotifyChange
                    End_Procedure
                    Procedure Add_New_Line String sSrc String sTarget
                        Send Add_Item Msg_None (sSrc + "-->" + sTarget)
                        Set Entry_State item (Item_Count(Self)-1) to False
                    End_Procedure
                    Procedure mInsertLine
                    End_Procedure
                    Procedure mRemoveLine
                        Integer iRowBase
                        If (Item_Count(Self)=0) Procedure_Return
                        Get Base_Row_Item (Current_Item(Self)) to iRowBase
                        Send Delete_Item (iRowBase+1)
                        Send Delete_Item iRowBase
                        Send onChange 0
                    End_Procedure
                    Procedure SetValue String sVal
                        Integer hoID iC
                        String sSep
                        Send Delete_Data
                        Get psSepCharacter  to sSep
                        Object oParser is a cLineParser
                            Set psSepCharacter  to sSep
                            Move Self   to hoID
                        End_Object
                        Send ParseLine to hoID sVal
                        For iC from 0 to (Item_Count(hoID)-1)
                            Send Add_Item Msg_None (Value(hoID,iC))
                        End
                        Send Destroy_Object to hoID
                    End_Procedure
                    Function GetValue Returns String
                        Integer iItem iItems
                        String sSep sRetVal sVal
                        Get Item_Count to iItems
                        If (iItems=0) Function_Return ""
                        Get psSepCharacter  to sSep
                        For iItem from 0 to (iItems-1)
                            Get Value item iItem to sVal
                            If (sRetVal="") Move sVal to sRetVal
                            Else Move (sRetVal+sSep+sVal) to sRetVal
                        Loop
                        Function_Return sRetVal
                    End_Function
                    Procedure OnChange
                        String sVal sSrc sTarget
                        Pointer pVal
                        Integer iRet
                        Forward Send OnChange
                        Get value item (current_item(Self)) to sVal
                        Move (Left(sVal,3)) to sSrc
                        Move (Replace(sSrc,sVal,"")) to sVal
                        Move (Replaces("-",sSrc,"")) to sSrc
                        Move (Replaces(">",sSrc,"")) to sSrc
                        Move (Replaces("-",sVal,"")) to sTarget
                        Move (Replaces(">",sTarget,"")) to sTarget
                        Set value of (oCharacter(Self)) to (Character(Integer(sSrc)))
                        Move ( (Trim(sTarget)) + " - " + (Character(Integer(sTarget)))) to sVal
                        Set oem_translate_state of (oTarget(Self)) to True
                        Set value of (oTarget(Self)) item 0 to sVal
                        Set oem_translate_state of (oTarget(Self)) to False
                    End_Procedure
                    Procedure LoadData String sVal
                        String sSrc sTarget
                        Send delete_data
                        If (Left(sVal,1)) Eq "|" Move (Replace("|",sVal,"")) to sVal
                        While ( (Pos("|",sVal)) Ne 0)
                            Move (Left(sVal,(Pos(";",sVal)))) to sSrc
                            Move (Replace(sSrc,sVal,"")) to sVal
                            Move (Replace(";",sSrc,"")) to sSrc
                            Move (Left(sVal,(Pos("|",sVal)))) to sTarget
                            Move (Replace(sTarget,sVal,"")) to sVal
                            Move (Replace("|",sTarget,"")) to sTarget
                            Send Add_New_Line sSrc sTarget
                        End
                        If (item_count(Self)) Gt 0 Begin
                            Set current_item to 0
                            Send OnChange
                        End
                    End_Procedure
                    Function SaveData Returns String
                        Integer iCou
                        String sVal sRet
                        If (item_count(Self)) Eq 0 Function_Return ""
                        For iCou from 0 to ( (item_count(Self)) -1)
                            Get value item iCou to sVal
                            Move (Replace("-->",sVal,";")) to sVal
                            Move (sRet + "|" + sVal) to sRet
                        Loop
                        If sRet Ne "" Move (sRet + "|") to sRet
                        Function_Return sRet
                    End_Function
                End_Object

                Object oCharacter is a Form
                    Set Size to 13 15
                    Set Location to 10 285
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to JMode_Right
                    Set Label to "Character to Translate"
                    Set OEM_Translate_State to False
                    Set Form_Margin item 0 to 1
                    Procedure OnChange
                        String sValue
                        Integer iVal
                        Get value to sValue
                        Move (Ascii(sValue)) to iVal
                        Set value of oValue  to iVal
                    End_Procedure  // OnChange
                End_Object

                Object oValue is a Form
                    Set Size to 13 35
                    Set Location to 10 325
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to JMode_Right
                    Set Label to "Value"
                    Set Enabled_State to False
                End_Object

                Object oTarget is a ComboForm
                    Set Size to 12 75
                    Set Location to 26 285
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to JMode_Right
                    Set Label to "Translate to"
                    Set Combo_Sort_State to False
                    Set Entry_State item 0 to False
                    Set Typeface to "Arial"
                    Set FontSize to 14 0
                    Set OEM_Translate_State to False
                    Procedure Combo_Fill_List
                        Integer iCou iRet
                        String sOem sVal
                        Pointer pVal
                        For iCou from 1 to 255 //32 to 254
                            Move ( (String(iCou)) + " - " + (Character(iCou)) + (Character(0))) to sVal
                            GetAddress of sVal to pVal
                            Move (OemToAnsi(pVal,pVal)) to iRet
                            Send combo_add_item (cString(sVal))
                        Loop
                    End_Procedure  // Combo_fill_list
                End_Object

                Object oAssign is a Button
                    Set Size to 13 50
                    Set Location to 10 366
                    Set Label to "Assign"
                    Procedure OnClick
                        String sSrc sVal sTarget sItem
                        Integer iCou iItem
                        Get value of (oValue(Self)) to sSrc
                        Get value of (oTarget(Self)) item 0 to sTarget
                        Move (Left(sTarget,(Pos("-",sTarget)))) to sTarget
                        Move (Replaces("-",sTarget,"")) to sTarget
                        Move (Trim(sTarget)) to sTarget
                        Move (sSrc + "-->" + sTarget) to sItem
                        Move -1 to iItem
                        For iCou from 0 to (item_count(oTranslate(Self))-1)
                            Get value of (oTranslate(Self)) item iCou to sVal
                            If (Left(sVal,(length(sSrc)))) Eq sSrc Begin
                                Move iCou to iItem
                                Move (item_count(oTranslate(Self))) to iCou
                            End
                        Loop
                        If iItem Eq -1 Begin
                            Send add_item to (oTranslate(Self)) msg_none " "
                            Move ( (item_count(oTranslate(Self))) -1) to iItem
                        End
                        If iItem Ne -1 Begin
                            Set value of (oTranslate(Self)) item iItem to sItem
                            Set current_item of (oTranslate(Self)) to iItem
                            Set select_state of (oTranslate(Self)) item iItem to True
                            Send onChange to (oTranslate(Self))
                        End
                        Delegate Send NotifyChange
                    End_Procedure // OnClick
                End_Object

                Object oRemove is a Button
                    Set Size to 13 50
                    Set Location to 26 366
                    Set Label to "Remove"
                    Procedure OnClick
                        Integer iSel
                        Get current_item of (oTranslate(Self)) to iSel
                        If iSel Ge 0 Begin
                            Send delete_item to (oTranslate(Self)) iSel
                            If (item_count(oTranslate(Self))) Gt 0 Begin
                                Set current_item of (oTranslate(Self)) to 0
                                Set select_state of (oTranslate(Self)) item 0 to True
                            End
                            Delegate Send NotifyChange
                        End
                    End_Procedure // OnClick
                End_Object

            End_Object // oTranslateGroup

            Procedure SaveEntries
                String sVal
                //
                Set pbCodeArtInsertComments    of ghoEditorProperties   to (Checked_State(oComments(Self)))
                Set pbCodeArtInsertDateTime    of ghoEditorProperties   to (Checked_State(oDate(Self)))
                Set pbCodeArtInsertErrors      of ghoEditorProperties   to (Checked_State(oWarnings(Self)))
                Set psCodePubHeaderFile        of ghoEditorProperties   to (Value(oHeaderFile(Self),0))
                Set psCodePubFooterFile        of ghoEditorProperties   to (Value(oFooterFile(Self),0))
                Get SaveData                   of (oTranslate(Self))    to sVal
                Set psCharTranslation          of ghoEditorProperties   to sVal
            End_Procedure

            Procedure LoadEntries
                Set Checked_State              of (oComments(Self))     to (pbCodeArtInsertComments(ghoEditorProperties))
                Set Checked_State              of (oDate(Self))         to (pbCodeArtInsertDateTime(ghoEditorProperties))
                Set Checked_State              of (oWarnings(Self))     to (pbCodeArtInsertErrors(ghoEditorProperties))
                Set Value                      of (oHeaderFile(Self))   to (psCodePubHeaderFile(ghoEditorProperties))
                Set Value                      of (oFooterFile(Self))   to (psCodePubFooterFile(ghoEditorProperties))
                Send LoadData                  to (oTranslate(Self))       (psCharTranslation(ghoEditorProperties))
            End_Procedure

        End_Object // oUtilityPage

        Object oLanguagePage is a TabPage
            Set Label to "&6. Language"
            Set pbHighlightTab to True
            Set piImageIndex to 5

            On_Key key_F2 Send SaveEntries
            On_Key kCancel Send Close_Panel
            
            Object oDBEditorGroup is a Group
                Set Size to 30 421
                Set Location to 2 6
                Set Label to "Editor Language"

                Object oLangSelect is a ComboForm
                    Set Size to 13 100
                    Set Location to 10 75
                    Set Label to "Name"
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to JMode_Right

                    On_Key key_F2 Send SaveEntries
                    On_Key kCancel Send Close_Panel
                    Procedure Combo_Fill_List
                        Integer iCount iC
                        String  sStr sCur
                        Get psLanguages.Count of ghoEditorProperties to iCount
                        For iC from 0 to (iCount-1)
                            Get psLanguages of ghoEditorProperties item iC  to sStr
                            Send Combo_Add_Item sStr
                        End
                        Get psLanguage of ghoEditorProperties to sCur
                        Set Value item 0    to sCur
                        Set Entry_State     to False
                    End_Procedure  // Combo_fill_list
                    // notification of a selection change or edit change
                    Procedure OnChange
                        String sName
                        Integer iC iRet
                        Get value item 0    to sName
                        If (sName<>"") Begin
                            Get FindLanguage of ghoEditorProperties sName to iC
                            If (iC>=0)  Send LoadEntries iC // Should load the entries!
                            Else        Send ClearEntries   // Should rest the values to empty!
                            Set Enabled_State of (oLanguage(Self)) to True
                        End
                        Else Set Enabled_State of (oLanguage(Self)) to False
                    End_Procedure  // OnChange
    
                    Procedure OnSetFocus
                        Forward Send OnSetFocus
                        Send OnChange
                    End_Procedure
                End_Object

                Object oLangLoad is a Button
                    Set Size to 13 85
                    Set Location to 10 180
                    Set Label to "Load from IDE/Studio"
                    Procedure OnClick
                        Send LoadFromDataFlexStudio
                    End_Procedure
                    On_Key key_F2 Send SaveEntries
                    On_Key kCancel Send Close_Panel
                End_Object

                Object oLangSave is a Button
                    Set Size to 13 45
                    Set Location to 10 270
                    Set Label to "Save"
                    Procedure OnClick
                        Send SaveEntries
                    End_Procedure
                End_Object

                Object oLangNew is a Button
                    Set Size to 13 45
                    Set Location to 10 320
                    Set Label to "New"
                    Procedure OnClick
                        Send Activate to (oLangSelect(Self))
                        Send Popup    to (oNewLanguage(Self))
                    End_Procedure
                End_Object

                Object oLangDelete is a Button
                    Set Size to 13 45
                    Set Location to 10 370
                    Set Label to "Delete"
                    Procedure OnClick
                        String sName
                        Integer iOK
                        Get Value of oLangSelect item 0 to sName
                        Get YesNo_Box ('Confirm You wish delete "' + sName + '" language definition?') "Confirmation" MBR_No to iOK
                        If (iOK=MBR_Yes) Begin
                            Send DeleteLanguage to ghoEditorProperties sName
                            Send Combo_Delete_Data to oLangSelect
                            Send Combo_Fill_List   to oLangSelect
                        End
                    End_Procedure
                End_Object
            End_Object

            Object oLanguageTabDialog is a TabDialog
                Set Size to 196 429
                Set Location to 36 4
                Set peTabStyle to tsFlatButtons

                Object oGeneralPage is a TabPage
                    Set Label to 'General'

                    Object oGeneralGroup is a Group
                        Set Size to 100 422
                        Set Location to -1 0

                        Object oProcedural is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 10 75
                            Set Label to "Procedural"
                        End_Object

                        Object oCase is a cNotifierCheckBox
                            Set Size to 10 50
                            Set Location to 26 75
                            Set Label to "Case Sensitive"
                        End_Object

                        Object oDelimiter is a cNotifierForm
                            Set Size to 13 50
                            Set Location to 42 75
                            Set Label to "String Delimiter"
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to JMode_Right
                        End_Object

                        Object oEscape is a cNotifierForm
                            Set Size to 13 50
                            Set Location to 58 75
                            Set Label to "Escape Character"
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to JMode_Right
                        End_Object

                        Object oLineTerm is a cNotifierForm
                            Set Size to 13 50
                            Set Location to 74 75
                            Set Label to "Line Termination"
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to JMode_Right
                        End_Object
                    End_Object

                    Object oCommentsGroup is a Group
                        Set Size to 78 422
                        Set Location to 100 0
                        Set Label to "Comments"

                        Object oSingle is a cNotifierForm
                            Set Size to 13 50
                            Set Location to 10 75
                            Set Label to "Single Line"
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to JMode_Right
                        End_Object

                        Object oMultiStart is a cNotifierForm
                            Set Size to 13 50
                            Set Location to 26 75
                            Set Label to "Multi Line Start"
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to JMode_Right
                        End_Object

                        Object oMultiStop is a cNotifierForm
                            Set Size to 13 50
                            Set Location to 42 75
                            Set Label to "Multi Line End"
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to JMode_Right
                        End_Object
                    End_Object

                    Procedure DoLoad tTHLanguage ByRef ltTHLanguage
                        Set Checked_State of oCase       to ltTHLanguage.iCaseSensitive
                        Set Checked_State of oProcedural to ltTHLanguage.iProcedural
                        Set Value of oDelimiter          to ltTHLanguage.sStringDelimiter
                        Set Value of oSingle             to ltTHLanguage.sLineComments
                        Set Value of oMultiStart         to ltTHLanguage.sMultiLineCommentStart
                        Set Value of oMultiStop          to ltTHLanguage.sMultiLineCommentStop
                    End_Procedure
                    
                End_Object // oGeneralPage

                Object oProceduralPage is a TabPage
                    Set Label to 'Procedural'

                    Object oProceduralGroup is a Group
                        Set Size to 179 424
                        Set Location to 0 0

                        Object oScopes is a cTHWSGrid
                            Property String  psSepCharacter  Public "\n"
                            Set Size to 130 155
                            Set Location to 10 6
                            Set Line_Width      to 2 0
                            Set Form_Width      0 to 76
                            Set Header_Label    0 to "Scope Start"
                            Set Form_Width      1 to 76
                            Set Header_Label    1 to "Scope End"
                            Set Status_Help item 0 to "Scope keyword start"
                            Set Status_Help item 1 to "Scope keyword stop"
                            On_Key key_F2 Send Request_SaveAllEntries
                            On_Key kCancel Send Close_Panel
                            On_Key kDownArrow Send mMoveDown
                            On_Key kUpArrow Send mMoveUp
                            On_Key Key_Tab Send mMoveDown
                            Procedure OnChange Integer iItem
                                Delegate Send NotifyChange
                            End_Procedure
                            Procedure Add_New_Line String sStart String sStop Integer iColor
                                Send Add_Item Msg_None sStart
                                If (iColor) Set ItemTextColor (Item_Count(Self)-1) to iColor
                                Send Add_Item Msg_None sStop
                                If (iColor) Set ItemTextColor (Item_Count(Self)-1) to iColor
                            End_Procedure
                            Procedure mInsertLine
                                Send Add_New_Line "" "" clRed
                                Send onChange 0
                                Send End_of_Data
                            End_Procedure
                            Procedure mRemoveLine
                                Integer iRowBase
                                If (Item_Count(Self)=0) Procedure_Return
                                Get Base_Row_Item (Current_Item(Self)) to iRowBase
                                Send Delete_Item (iRowBase+1)
                                Send Delete_Item iRowBase
                                Send onChange 0
                            End_Procedure
                            Procedure mMoveDown
                                Integer iCount iRowBase
                                String  sStart sStop
                                Get Item_Count to iCount
                                Get Base_Row_Item (Current_Item(Self)) to iRowBase
                                Get Value item iRowBase to sStart
                                Get Value item (iRowBase+1) to sStop
                                If (sStart="") Set Current_Item to iRowBase
                                Else If (sStop="") Set Current_Item to (iRowBase+1)
                                Else Begin
                                    If (iRowBase=(iCount-2)) Begin
                                        Send mInsertLine
                                        Set Current_Item to (iRowBase+2)
                                    End
                                    Send Down
                                    Set Current_Item to (iRowBase+2)
                                End
                            End_Procedure
                            Procedure mMoveUp
                                Integer iRowBase
                                String  sStart sStop
                                Get Base_Row_Item (Current_Item(Self)) to iRowBase
                                Get Value item iRowBase to sStart
                                Get Value item (iRowBase+1) to sStop
                                If ((sStart="")and(sStop="")) Send mRemoveLine
                                Else If ((sStart="")or(sStop="")) Begin
                                    Send Stop_Box "Scope 'Start' and 'Stop' keywords must be specified!"
                                End
                                Else Send Up
                            End_Procedure
                            Function GetValue Integer iColumn Returns String
                                Integer iC iColumns
                                String  sRet sSep
                                Move (low(matrix_size(Self))) to iColumns
                                Get psSepCharacter to sSep
                                If (sSep="") Move "\n" to sSep
                                For iC from 0 to (Item_Count(Self)-1)
                                    If (Value(Self,iC+iColumn)<>"") Begin
                                        If (sRet<>"") Move (sRet+sSep) to sRet
                                        Move (sRet+Value(Self,iC+iColumn)) to sRet
                                    End
                                    Move (iC+iColumns-1)   to iC
                                End
                                Function_Return sRet
                            End_Function
                            Procedure DoLoad tTHLanguage ByRef ltTHLanguage
                                Integer iScope iScopes
                                Send Delete_Data
                                Move (SizeOfArray(ltTHLanguage.saScopeStart)) to iScopes
                                For iScope from 0 to (iScopes-1)
                                    Send Add_New_Line ltTHLanguage.saScopeStart[iScope] ltTHLanguage.saScopeStop[iScope] 0
                                Loop
                            End_Procedure
                        End_Object

                        Object oAdd is a Button
                            Set Location to 145 7
                            Set Label to "Add (Ins)"
                            Procedure OnClick
                                Send mInsertLine to oScopes
                            End_Procedure
                        End_Object

                        Object oRemove is a Button
                            Set Location to 145 62
                            Set Label to "Remove (Del)"
                            Procedure OnClick
                                Send mRemoveLine to oScopes
                            End_Procedure
                        End_Object

                        Object oKeywords is a cTHWSGrid
                            Property String  psSepCharacter  Public "\n"
                            Set Size to 130 114
                            Set Location to 10 176
                            Set Line_Width      to 1 0
                            Set Form_Width      0 to 110
                            Set Header_Label    0 to "Keyword"
                            Set Status_Help item 0 to "Descriptions to be shown in The Hammer Open File Dialog"
                            On_Key key_F2 Send Request_SaveAllEntries
                            On_Key kCancel Send Close_Panel
                            On_Key kUpArrow Send mMoveUp
                            On_Key kDownArrow Send mMoveDown
                            On_Key Key_Tab Send mMoveDown
                            Procedure mMoveUp
                                Integer iItem
                                String sValue
                                Get Current_Item to iItem
                                Get Value item iItem to sValue
                                If ((iItem=Item_Count(Self)-1)and(sValue="")) Send mRemoveLine
                                Else Send Up
                            End_Procedure
                            Procedure mMoveDown
                                Integer iItem
                                String sValue
                                Get Current_Item to iItem
                                Get Value item iItem to sValue
                                If (sValue<>"") Begin
                                    If (iItem=Item_Count(Self)-1) Send Add_New_Line "" 0
                                    Send Down
                                End
                            End_Procedure
                            Procedure OnChange Integer iItem
                                Delegate Send NotifyChange
                            End_Procedure
                            Procedure Add_New_Line String sKeyword Integer iColor
                                Send Add_Item Msg_None sKeyword
                                If (iColor) Set ItemTextColor (Item_Count(Self)-1) to iColor
                            End_Procedure
                            Procedure mInsertLine
                                Send Add_New_Line "" clRed
                                Send onChange 0
                                Send End_of_Data
                            End_Procedure
                            Procedure mRemoveLine
                                Integer iRowBase
                                If (Item_Count(Self)=0) Procedure_Return
                                Get Base_Row_Item (Current_Item(Self)) to iRowBase
                                Send Delete_Item iRowBase
                                Send onChange 0
                            End_Procedure
                            Function GetValue Integer iColumn Returns String
                                Integer iC iColumns
                                String  sRet sSep
                                Move (low(matrix_size(Self))) to iColumns
                                Get psSepCharacter to sSep
                                If (sSep="") Move "\n" to sSep
                                For iC from 0 to (Item_Count(Self)-1)
                                    If (Value(Self,iC+iColumn)<>"") Begin
                                        If (sRet<>"") Move (sRet+sSep) to sRet
                                        Move (sRet+Value(Self,iC+iColumn)) to sRet
                                    End
                                    Move (iC+iColumns-1)   to iC
                                End
                                Function_Return sRet
                            End_Function
                            Procedure DoLoad tTHLanguage ByRef ltTHLanguage
                                Integer iKeyword iKeywords
                                Send Delete_Data
                                Move (SizeOfArray(ltTHLanguage.saKeywords)) to iKeywords
                                For iKeyword from 0 to (iKeywords-1)
                                    Send Add_New_Line ltTHLanguage.saKeywords[iKeyword] 0
                                Loop
                            End_Procedure
                        End_Object

                        Object oAdd is a Button
                            Set Location to 145 176
                            Set Label to "Add (Ins)"
                            Procedure OnClick
                                Send mInsertLine to oKeywords
                            End_Procedure
                        End_Object

                        Object oRemove is a Button
                            Set Location to 145 231
                            Set Label to "Remove (Del)"
                            Procedure OnClick
                                Send mRemoveLine to oKeywords
                            End_Procedure
                        End_Object

                        Object oOperators is a cTHWSGrid
                            Property String  psSepCharacter  Public "\n"
                            Set Size to 131 114
                            Set Location to 10 306
                            Set Line_Width      to 1 0
                            Set Form_Width      0 to 110
                            Set Header_Label    0 to "Operator"
                            Set Status_Help item 0 to "Descriptions to be shown in The Hammer Open File Dialog"
                            On_Key key_F2 Send Request_SaveAllEntries
                            On_Key kCancel Send Close_Panel
                            On_Key kUpArrow Send mMoveUp
                            On_Key kDownArrow Send mMoveDown
                            On_Key Key_Tab Send mMoveDown
                            Procedure mMoveUp
                                Integer iItem
                                String sValue
                                Get Current_Item to iItem
                                Get Value item iItem to sValue
                                If ((iItem=Item_Count(Self)-1)and(sValue="")) Send mRemoveLine
                                Else Send Up
                            End_Procedure
                            Procedure mMoveDown
                                Integer iItem
                                String sValue
                                Get Current_Item to iItem
                                Get Value item iItem to sValue
                                If (sValue<>"") Begin
                                    If (iItem=Item_Count(Self)-1) Send Add_New_Line "" 0
                                    Send Down
                                End
                            End_Procedure
                            Procedure OnChange Integer iItem
                                Delegate Send NotifyChange
                            End_Procedure
                            Procedure Add_New_Line String sOperator Integer iColor
                                Send Add_Item Msg_None sOperator
                                If (iColor) Set ItemTextColor (Item_Count(Self)-1) to iColor
                            End_Procedure
                            Procedure mInsertLine
                                Send Add_New_Line "" clRed
                                Send onChange 0
                                Send End_of_Data
                            End_Procedure
                            Procedure mRemoveLine
                                Integer iRowBase
                                If (Item_Count(Self)=0) Procedure_Return
                                Get Base_Row_Item (Current_Item(Self)) to iRowBase
                                Send Delete_Item iRowBase
                                Send onChange 0
                            End_Procedure
                            Function GetValue Integer iColumn Returns String
                                Integer iC iColumns
                                String  sRet sSep
                                Move (low(matrix_size(Self))) to iColumns
                                Get psSepCharacter to sSep
                                If (sSep="") Move "\n" to sSep
                                For iC from 0 to (Item_Count(Self)-1)
                                    If (Value(Self,iC+iColumn)<>"") Begin
                                        If (sRet<>"") Move (sRet+sSep) to sRet
                                        Move (sRet+Value(Self,iC+iColumn)) to sRet
                                    End
                                    Move (iC+iColumns-1)   to iC
                                End
                                Function_Return sRet
                            End_Function
                            Procedure DoLoad tTHLanguage ByRef ltTHLanguage
                                Integer iOperator iOperators
                                Send Delete_Data
                                Move (SizeOfArray(ltTHLanguage.saOperators)) to iOperators
                                For iOperator from 0 to (iOperators-1)
                                    Send Add_New_Line ltTHLanguage.saOperators[iOperator] 0
                                Loop
                            End_Procedure
                        End_Object

                        Object oAdd is a Button
                            Set Location to 145 307
                            Set Label to "Add (Ins)"
                            Procedure OnClick
                                Send mInsertLine to oOperators
                            End_Procedure
                        End_Object

                        Object oRemove is a Button
                            Set Location to 145 362
                            Set Label to "Remove (Del)"
                            Procedure OnClick
                                Send mRemoveLine to oOperators
                            End_Procedure
                        End_Object

                        Object oLineControl2 is a LineControl
                            Set Size to 145 3
                            Set Location to 11 168
                            Set Horizontal_State to False
                        End_Object

                        Object oLineControl2 is a LineControl
                            Set Size to 145 3
                            Set Location to 11 298
                            Set Horizontal_State to False
                        End_Object

                        Object oClear is a Button
                            Set Location to 161 7
                            Set Label to "Clear Grids"
                            Procedure OnClick
                                Send Delete_Data to oScopes
                                Send Delete_Data to oKeywords
                                Send Delete_Data to oOperators
                                Send mInsertLine to oScopes
                                Send mInsertLine to oKeywords
                                Send mInsertLine to oOperators
                            End_Procedure
                        End_Object

                    End_Object
                End_Object //oProceduralPage

                Object oSGMLPage is a TabPage
                    Set Label to 'SGML'

                    Object oSGMLGroup is a Group
                        Set Size to 179 424
                        Set Location to 0 0

                        Object oTagNames is a cTHWSGrid
                            Property String  psSepCharacter  Public "\n"
                            Set Size to 140 130
                            Set Location to 10 6
                            Set Line_Width      to 1 0
                            Set Form_Width      0 to 127
                            Set Header_Label    0 to "Tag Name"
                            Set Status_Help item 0 to "Descriptions to be shown in The Hammer Open File Dialog"
                            On_Key key_F2 Send Request_SaveAllEntries
                            On_Key kCancel Send Close_Panel
                            On_Key kUpArrow Send mMoveUp
                            On_Key kDownArrow Send mMoveDown
                            On_Key Key_Tab Send mMoveDown
                            Procedure mMoveUp
                                Integer iItem
                                String sValue
                                Get Current_Item to iItem
                                Get Value item iItem to sValue
                                If ((iItem=Item_Count(Self)-1)and(sValue="")) Send mRemoveLine
                                Else Send Up
                            End_Procedure
                            Procedure mMoveDown
                                Integer iItem
                                String sValue
                                Get Current_Item to iItem
                                Get Value item iItem to sValue
                                If (sValue<>"") Begin
                                    If (iItem=Item_Count(Self)-1) Send Add_New_Line "" 0
                                    Send Down
                                End
                            End_Procedure
                            Procedure OnChange Integer iItem
                                Delegate Send NotifyChange
                            End_Procedure
                            Procedure Add_New_Line String sTag Integer iColor
                                Send Add_Item Msg_None sTag
                                If (iColor) Set ItemTextColor (Item_Count(Self)-1) to iColor
                            End_Procedure
                            Procedure mInsertLine
                                Send Add_New_Line "" "" clRed
                                Send onChange 0
                                Send End_of_Data
                            End_Procedure
                            Procedure mRemoveLine
                                Integer iRowBase
                                If (Item_Count(Self)=0) Procedure_Return
                                Get Base_Row_Item (Current_Item(Self)) to iRowBase
                                Send Delete_Item (iRowBase+1)
                                Send Delete_Item iRowBase
                                Send onChange 0
                            End_Procedure
                            Function GetValue Integer iColumn Returns String
                                Integer iC iColumns
                                String  sRet sSep
                                Move (low(matrix_size(Self))) to iColumns
                                Get psSepCharacter to sSep
                                If (sSep="") Move "\n" to sSep
                                For iC from 0 to (Item_Count(Self)-1)
                                    If (Value(Self,iC+iColumn)<>"") Begin
                                        If (sRet<>"") Move (sRet+sSep) to sRet
                                        Move (sRet+Value(Self,iC+iColumn)) to sRet
                                    End
                                    Move (iC+iColumns-1)   to iC
                                End
                                Function_Return sRet
                            End_Function
                            Procedure DoLoad tTHLanguage ByRef ltTHLanguage
                                Integer iItem iItems
                                Send Delete_Data
                                Move (SizeOfArray(ltTHLanguage.saTags)) to iItems
                                For iItem from 0 to (iItems-1)
                                    Send Add_New_Line ltTHLanguage.saTags[iItem] 0
                                Loop
                            End_Procedure
                        End_Object

                        Object oAdd is a Button
                            Set Location to 155 6
                            Set Label to "Add (Ins)"
                            Procedure OnClick
                                Send mInsertLine to oTagNames
                            End_Procedure
                        End_Object

                        Object oRemove is a Button
                            Set Location to 155 61
                            Set Label to "Remove (Del)"
                            Procedure OnClick
                                Send mRemoveLine to oTagNames
                            End_Procedure
                        End_Object

                        Object oTagEntities is a cTHWSGrid
                            Property String  psSepCharacter  Public "\n"
                            Set Size to 140 130
                            Set Location to 10 150
                            Set Line_Width      to 1 0
                            Set Form_Width      0 to 127
                            Set Header_Label    0 to "Tag Entity"
                            Set Status_Help item 0 to "Descriptions to be shown in The Hammer Open File Dialog"
                            On_Key key_F2 Send Request_SaveAllEntries
                            On_Key kCancel Send Close_Panel
                            On_Key kUpArrow Send mMoveUp
                            On_Key kDownArrow Send mMoveDown
                            On_Key Key_Tab Send mMoveDown
                            Procedure mMoveUp
                                Integer iItem
                                String sValue
                                Get Current_Item to iItem
                                Get Value item iItem to sValue
                                If ((iItem=Item_Count(Self)-1)and(sValue="")) Send mRemoveLine
                                Else Send Up
                            End_Procedure
                            Procedure mMoveDown
                                Integer iItem
                                String sValue
                                Get Current_Item to iItem
                                Get Value item iItem to sValue
                                If (sValue<>"") Begin
                                    If (iItem=Item_Count(Self)-1) Send Add_New_Line "" 0
                                    Send Down
                                End
                            End_Procedure
                            Procedure OnChange Integer iItem
                                Delegate Send NotifyChange
                            End_Procedure
                            Procedure Add_New_Line String sEntity Integer iColor
                                Send Add_Item Msg_None sEntity
                                If (iColor) Set ItemTextColor (Item_Count(Self)-1) to iColor
                            End_Procedure
                            Procedure mInsertLine
                                Send Add_New_Line "" "" clRed
                                Send onChange 0
                                Send End_of_Data
                            End_Procedure
                            Procedure mRemoveLine
                                Integer iRowBase
                                If (Item_Count(Self)=0) Procedure_Return
                                Get Base_Row_Item (Current_Item(Self)) to iRowBase
                                Send Delete_Item (iRowBase+1)
                                Send Delete_Item iRowBase
                                Send onChange 0
                            End_Procedure
                            Function GetValue Integer iColumn Returns String
                                Integer iC iColumns
                                String  sRet sSep
                                Move (low(matrix_size(Self))) to iColumns
                                Get psSepCharacter to sSep
                                If (sSep="") Move "\n" to sSep
                                For iC from 0 to (Item_Count(Self)-1)
                                    If (Value(Self,iC+iColumn)<>"") Begin
                                        If (sRet<>"") Move (sRet+sSep) to sRet
                                        Move (sRet+Value(Self,iC+iColumn)) to sRet
                                    End
                                    Move (iC+iColumns-1)   to iC
                                End
                                Function_Return sRet
                            End_Function
                            Procedure DoLoad tTHLanguage ByRef ltTHLanguage
                                Integer iItem iItems
                                Send Delete_Data
                                Move (SizeOfArray(ltTHLanguage.saEntities)) to iItems
                                For iItem from 0 to (iItems-1)
                                    Send Add_New_Line ltTHLanguage.saEntities[iItem] 0
                                Loop
                            End_Procedure
                        End_Object

                        Object oAdd is a Button
                            Set Location to 155 150
                            Set Label to "Add (Ins)"
                            Procedure OnClick
                                Send mInsertLine to oTagEntities
                            End_Procedure
                        End_Object

                        Object oRemove is a Button
                            Set Location to 155 205
                            Set Label to "Remove (Del)"
                            Procedure OnClick
                                Send mRemoveLine to oTagEntities
                            End_Procedure
                        End_Object

                        Object oTagAttributes is a cTHWSGrid
                            Property String  psSepCharacter  Public "\n"
                            Set Size to 140 125
                            Set Location to 10 294
                            Set Line_Width      to 1 0
                            Set Form_Width      0 to 127
                            Set Header_Label    0 to "Tag Attribute"
                            Set Status_Help item 0 to "Descriptions to be shown in The Hammer Open File Dialog"
                            On_Key key_F2 Send Request_SaveAllEntries
                            On_Key kCancel Send Close_Panel
                            On_Key kUpArrow Send mMoveUp
                            On_Key kDownArrow Send mMoveDown
                            On_Key Key_Tab Send mMoveDown
                            Procedure mMoveUp
                                Integer iItem
                                String sValue
                                Get Current_Item to iItem
                                Get Value item iItem to sValue
                                If ((iItem=Item_Count(Self)-1)and(sValue="")) Send mRemoveLine
                                Else Send Up
                            End_Procedure
                            Procedure mMoveDown
                                Integer iItem
                                String sValue
                                Get Current_Item to iItem
                                Get Value item iItem to sValue
                                If (sValue<>"") Begin
                                    If (iItem=Item_Count(Self)-1) Send Add_New_Line "" 0
                                    Send Down
                                End
                            End_Procedure
                            Procedure OnChange Integer iItem
                                Delegate Send NotifyChange
                            End_Procedure
                            Procedure Add_New_Line String sAttribute Integer iColor
                                Send Add_Item Msg_None sAttribute
                                If (iColor) Set ItemTextColor (Item_Count(Self)-1) to iColor
                            End_Procedure
                            Procedure mInsertLine
                                Send Add_New_Line "" "" clRed
                                Send onChange 0
                                Send End_of_Data
                            End_Procedure
                            Procedure mRemoveLine
                                Integer iRowBase
                                If (Item_Count(Self)=0) Procedure_Return
                                Get Base_Row_Item (Current_Item(Self)) to iRowBase
                                Send Delete_Item (iRowBase+1)
                                Send Delete_Item iRowBase
                                Send onChange 0
                            End_Procedure
                            Function GetValue Integer iColumn Returns String
                                Integer iC iColumns
                                String  sRet sSep
                                Move (low(matrix_size(Self))) to iColumns
                                Get psSepCharacter to sSep
                                If (sSep="") Move "\n" to sSep
                                For iC from 0 to (Item_Count(Self)-1)
                                    If (Value(Self,iC+iColumn)<>"") Begin
                                        If (sRet<>"") Move (sRet+sSep) to sRet
                                        Move (sRet+Value(Self,iC+iColumn)) to sRet
                                    End
                                    Move (iC+iColumns-1)   to iC
                                End
                                Function_Return sRet
                            End_Function
                            Procedure DoLoad tTHLanguage ByRef ltTHLanguage
                                Integer iItem iItems
                                Send Delete_Data
                                Move (SizeOfArray(ltTHLanguage.saAttributes)) to iItems
                                For iItem from 0 to (iItems-1)
                                    Send Add_New_Line ltTHLanguage.saAttributes[iItem] 0
                                Loop
                            End_Procedure
                        End_Object

                        Object oAdd is a Button
                            Set Location to 155 294
                            Set Label to "Add (Ins)"
                            Procedure OnClick
                                Send mInsertLine to oTagAttributes
                            End_Procedure
                        End_Object

                        Object oRemove is a Button
                            Set Location to 155 349
                            Set Label to "Remove (Del)"
                            Procedure OnClick
                                Send mRemoveLine to oTagAttributes
                            End_Procedure
                        End_Object
                        Object oLineControl2 is a LineControl
                            Set Size to 162 3
                            Set Location to 11 287
                            Set Horizontal_State to False
                        End_Object
                        Object oLineControl2 is a LineControl
                            Set Size to 162 3
                            Set Location to 11 143
                            Set Horizontal_State to False
                        End_Object
                    End_Object
                End_Object // 

            End_Object // oLanguageTabDialog

            Procedure LoadElementString String sElement String sSeparator String[] ByRef saElements
                Integer iC iItem
                Handle hoParser
                Get Create U_cLineParser    to hoParser
                Set psSepCharacter          of hoParser to sSeparator
                Send ParseLine              to hoParser sElement
                For iC from 0 to (Item_Count(hoParser)-1)
                    Move (SizeOfArray(saElements)) to iItem
                    Get Value of hoParser item iC to saElements[iItem]
                End
                Send Destroy_Object to hoParser
            End_Procedure
            Function LoadFromIDE String sVersion Returns tTHLanguage
                tTHLanguage ltTHLanguage
                Send LoadElementString (Profile_StringVersion(sVersion,"IDE\Code-Editor","ScopeKeywordsStart")) "," (&ltTHLanguage.saScopeStart)
                Send LoadElementString (Profile_StringVersion(sVersion,"IDE\Code-Editor","ScopeKeywordsEnd"))   "," (&ltTHLanguage.saScopeStop)
                Send LoadElementString (Profile_StringVersion(sVersion,"IDE\Code-Editor","Keywords"))           "," (&ltTHLanguage.saKeywords)
                Send LoadElementString (Profile_StringVersion(sVersion,"IDE\Code-Editor","Operators"))          "," (&ltTHLanguage.saOperators)
                Move "//"           to ltTHLanguage.sLineComments
                Move ('"'+"\n"+"'") to ltTHLanguage.sStringDelimiter
                Function_Return ltTHLanguage
            End_Function
            Procedure LoadFromDataFlexStudio
                tTHLanguage ltTHLanguage
                Integer iOK
                String sLanguage sVdfConfig sVersion
                Get Value of oLangSelect to sLanguage
                Get psVdfRootDir of ghoWorkSpaceHandlerEx to sVdfConfig
                Get YesNo_Box ("Confirm You wish to load" * sLanguage * "definition from the IDE/Studio\n("+sVdfConfig+")?") "Confirmation" MBR_Yes to iOK
                If (iOK=MBR_Yes) Begin
                    Get psVDFRegistryVersion of ghoEditorProperties to sVersion
                    If (sVersion<"12.0") ;
                        Get LoadFromIDE sVersion to ltTHLanguage
                    Else ;
                        Get LoadLanguage sLanguage to ltTHLanguage
                    Send DoLoad to oGeneralPage (&ltTHLanguage)
                    Send DoLoad to oScopes      (&ltTHLanguage)
                    Send DoLoad to oKeywords    (&ltTHLanguage)
                    Send DoLoad to oOperators   (&ltTHLanguage)
                End
            End_Procedure

            Procedure SaveEntries
                Integer iC
                String  sName
                Get value of oLangSelect item 0 to sName
                If (sName="") Procedure_Return
                Get YesNo_Box ("Do You wish to save" *sName * "setup?") "Confirmation"  to iC
                If (iC<>MBR_Yes) Procedure_Return
                Get FindLanguage                            of ghoEditorProperties sName to iC
                If iC Lt 0 ;
                     Get psLanguages.Count                  of ghoEditorProperties         to iC
                Set psLanguages                             of ghoEditorProperties item iC to sName
                Set psLanguages.dwStyle                     of ghoEditorProperties item iC to (Checked_State(oProcedural(Self)))
                Set psLanguages.bIsCaseSensitive            of ghoEditorProperties item iC to (Checked_State(oCase(Self)))

                Set psLanguages.szStringDelims              of ghoEditorProperties item iC to (Value(oDelimiter(Self),0))
                Set psLanguages.chEscape                    of ghoEditorProperties item iC to (Value(oEscape(Self),0))
                Set psLanguages.chTerminator                of ghoEditorProperties item iC to (Value(oLineTerm(Self),0))

                Set psLanguages.szSingleLineComments        of ghoEditorProperties item iC to (Value(oSingle(Self),0))
                Set psLanguages.szMultiLineComments1        of ghoEditorProperties item iC to (Value(oMultiStart(Self),0))
                Set psLanguages.szMultiLineComments2        of ghoEditorProperties item iC to (Value(oMultiStop(Self),0))

                Set psLanguages.szScopeKeywords1            of ghoEditorProperties item iC to (GetValue(oScopes(Self), 0))
                Set psLanguages.szScopeKeywords2            of ghoEditorProperties item iC to (GetValue(oScopes(Self), 1))
                Set psLanguages.szKeywords                  of ghoEditorProperties item iC to (GetValue(oKeywords(Self), 0))
                Set psLanguages.szOperators                 of ghoEditorProperties item iC to (GetValue(oOperators(Self), 0))
                Set psLanguages.pszTagElementNames          of ghoEditorProperties item iC to (GetValue(oTagNames(Self),0))
                Set psLanguages.pszTagAttributeNames        of ghoEditorProperties item iC to (GetValue(oTagAttributes(Self),0))
                Set psLanguages.pszTagEntities              of ghoEditorProperties item iC to (GetValue(oTagEntities(Self),0))
                Send Activate   to oLangSelect
                Send RegisterLanguage to ghoEditorProperties iC
            End_Procedure

            Procedure LoadEntries Integer iC
                tTHLanguage ltTHLanguage
                Get psLanguages.dwStyle                 of ghoEditorProperties iC to ltTHLanguage.iProcedural
                Get psLanguages.bIsCaseSensitive        of ghoEditorProperties iC to ltTHLanguage.iCaseSensitive
                Get psLanguages.szStringDelims          of ghoEditorProperties iC to ltTHLanguage.sStringDelimiter
                Get psLanguages.chEscape                of ghoEditorProperties iC to ltTHLanguage.sEscapeChar
                Get psLanguages.chTerminator            of ghoEditorProperties iC to ltTHLanguage.sLineTerminationChar
                Get psLanguages.szSingleLineComments    of ghoEditorProperties iC to ltTHLanguage.sLineComments
                Get psLanguages.szMultiLineComments1    of ghoEditorProperties iC to ltTHLanguage.sMultiLineCommentStart
                Get psLanguages.szMultiLineComments2    of ghoEditorProperties iC to ltTHLanguage.sMultiLineCommentStop

                Send LoadElementString (psLanguages.szScopeKeywords1(ghoEditorProperties,iC))       "\n" (&ltTHLanguage.saScopeStart)
                Send LoadElementString (psLanguages.szScopeKeywords2(ghoEditorProperties,iC))       "\n" (&ltTHLanguage.saScopeStop)
                Send LoadElementString (psLanguages.szKeywords(ghoEditorProperties,iC))             "\n" (&ltTHLanguage.saKeywords)
                Send LoadElementString (psLanguages.szOperators(ghoEditorProperties,iC))            "\n" (&ltTHLanguage.saOperators)

                Send LoadElementString (psLanguages.pszTagElementNames(ghoEditorProperties,iC))     "\n" (&ltTHLanguage.saTags)
                Send LoadElementString (psLanguages.pszTagAttributeNames(ghoEditorProperties,iC))   "\n" (&ltTHLanguage.saAttributes)
                Send LoadElementString (psLanguages.pszTagEntities(ghoEditorProperties,iC))         "\n" (&ltTHLanguage.saEntities)

                Send DoLoad to oGeneralPage (&ltTHLanguage)
                Send DoLoad to oScopes      (&ltTHLanguage)
                Send DoLoad to oKeywords    (&ltTHLanguage)
                Send DoLoad to oOperators   (&ltTHLanguage)
                
                Send DoLoad to oTagNames       (&ltTHLanguage)
                Send DoLoad to oTagEntities    (&ltTHLanguage)
                Send DoLoad to oTagAttributes  (&ltTHLanguage)
            End_Procedure

            Procedure ClearEntries
                Set Checked_State   of oProcedural  to 0
                Set Checked_State   of oCase        to 0
                Set Value           of oDelimiter   to ""
                Set Value           of oEscape      to ""
                Set Value           of oLineTerm    to ""
                Set Value           of oSingle      to ""
                Set Value           of oMultiStart  to ""
                Set Value           of oMultiStop   to ""
                
                Send Delete_Data    to oScopes
                Send Delete_Data    to oKeywords
                Send Delete_Data    to oOperators

                Send Delete_Data    to oTagNames
                Send Delete_Data    to oTagEntities
                Send Delete_Data    to oTagAttributes
            End_Procedure
            
        End_Object // oLanguagePage
        
    End_Object // oParameters

    Procedure NotifyChange
        Set Enabled_State of oSave to True
    End_Procedure
    Procedure Request_SaveAllEntries
        If (Enabled_State(oSave(Self))) Send SaveAllEntries
    End_Procedure
    
    Procedure ApplyToEditor
        Handle hClientArea hView
        Get Client_Id to hClientArea
        Get Next_Mdi_Dialog of hClientArea True to hView // find first view
        While (hView <> 0)
            If (Active_State(hView)) Begin
                // create the action
                Send ApplyEditorOptions to (oEdit(hView))
                Send SetAdjustments     to (oEdit(hView))
                Send onPropsChange      to (oEdit(hView))
            End
            Get Next_Mdi_Dialog of hClientArea False to hView // find next
        Loop
		If ghoToolsPane     Send ColorsLikeEdit to (oToolpane(ghoToolsPane))
		If ghoOutputPane    Send ColorsLikeEdit to (oOutputPane(ghoOutputPane))
    End_Procedure
    
    Procedure SaveAllEntries
        Send SaveEntries    to oEditorPage
        Send SaveEntries    to oSourcePage
        Send SaveEntries    to oDatabasePage
        Send SaveEntries    to oBuildPage
        Send SaveEntries    to oUtilityPage
        Send SaveIni to ghoEditorProperties
        If (Focus(Desktop)=oSave(Self)) Send activate to (oClose(Self))
        Send ApplyToEditor
        Set Enabled_State of oSave to False
    End_Procedure

    Procedure Entering_Scope
        Integer hoLocalStatusBar
        Get StatusBar_ID to hoLocalStatusBar
        Move (oStatusHelp(Self)) to hoLocalStatusBar
        Set StatusBar_ID to hoLocalStatusBar
        Forward Send Entering_Scope
    End_Procedure // Entering_Scope

    Procedure Activating Returns Integer
        Integer iretval
        Forward Get msg_activating to iretval
        Set Enabled_State of oSave to False
        Procedure_Return iretval
    End_Procedure

    Procedure Popup
        Send LoadEntries to oEditorPage
        Send LoadEntries to oBuildPage
        Send LoadEntries to oSourcePage
        Send LoadEntries to oDatabasePage
        Send LoadEntries to oUtilityPage
        Forward Send Popup
    End_Procedure

    Object oSave is a Button
        Set Label to "Save"
        Set Location to 256 336
        Set peAnchors to anBottomRight
        Set Enabled_State to False
        Procedure OnClick
            Send SaveAllEntries
        End_Procedure
    End_Object

    Object oClose is a Button
        Set Label to "Close"
        Set Location to 256 391
        Set peAnchors to anBottomRight
        Procedure OnClick
            Send Close_Panel
        End_Procedure
    End_Object

    Object oStatusHelp is a TextBox
        Set Auto_Size_State to False
        Set Size to 13 325
        Set Location to 257 6
        Set Label to " Status"
        Set Color to clInfoBk
        Set Border_Style to Border_Normal
        Procedure Show_Status_Help String sHelp
          Set Label to (' '+sHelp)
        End_Procedure
    End_Object

    On_Key Key_Alt+Key_O Send KeyAction of oSave
    On_Key Key_Alt+Key_C Send KeyAction of oClose

End_Object
